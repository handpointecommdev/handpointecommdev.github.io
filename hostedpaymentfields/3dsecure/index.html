<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-hostedpaymentfields docs-doc-id-3dsecure">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">3D Secure &amp; Strong Customer Authentication (SCA) | Handpoint</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developer-ecomm.handpoint.io/hostedpaymentfields/3dsecure"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-hostedpaymentfields-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-hostedpaymentfields-current"><meta data-rh="true" property="og:title" content="3D Secure &amp; Strong Customer Authentication (SCA) | Handpoint"><meta data-rh="true" name="description" content="PSD2 SCA Compliance"><meta data-rh="true" property="og:description" content="PSD2 SCA Compliance"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://developer-ecomm.handpoint.io/hostedpaymentfields/3dsecure"><link data-rh="true" rel="alternate" href="https://developer-ecomm.handpoint.io/hostedpaymentfields/3dsecure" hreflang="en"><link data-rh="true" rel="alternate" href="https://developer-ecomm.handpoint.io/hostedpaymentfields/3dsecure" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RNDFP191TE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RNDFP191TE",{anonymize_ip:!0})</script>









<script src="https:////js-eu1.hs-scripts.com/25846579.js"></script><link rel="stylesheet" href="/assets/css/styles.423f145a.css">
<link rel="preload" href="/assets/js/runtime~main.69ab9cf3.js" as="script">
<link rel="preload" href="/assets/js/main.f54a2a29.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://developer.handpoint.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA" width="75"><img src="/img/handpoint-logo-hvitt.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU" width="75"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/cnpdocs">Getting Started</a><a class="navbar__item navbar__link" href="/docs/overview">Hosted Payment Page</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hostedpaymentfields/overview">Hosted Payment Fields</a><a class="navbar__item navbar__link" href="/directintegration/overview">Direct Integration</a><a class="navbar__item navbar__link" href="/batchintegration/overview">Batch Integration</a><a class="navbar__item navbar__link" href="/paybutton/basicpaybutton">Pay By Link</a><a class="navbar__item navbar__link" href="/shoppingcarts/shoppingcarts">Shopping Carts</a><a class="navbar__item navbar__link" href="/mobilesdks/mobilesdks">Mobile SDKs</a></div><div class="navbar__items navbar__items--right"><a href="https://status.handpoint.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-statuspage-icon" aria-label="Status Page"></a><a href="https://github.com/handpoint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/samplecode">Sample Code &amp; Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/transactiontypes">Transaction Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/hostedpaymentfields/3dsecure">3D Secure &amp; Strong Customer Authentication (SCA)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/credentialsonfile">Credentials on file &amp; Recurring Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/digitalwalletsandapms">Digital Wallets and Alternative Payment Methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/advancedfunctionalities">Advanced Gateway Functionalities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/advanceddata">Extra Transaction Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hostedpaymentfields/annexes">Annexes</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3D Secure &amp; Strong Customer Authentication (SCA)</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3D Secure &amp; Strong Customer Authentication (SCA)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="psd2-sca-compliance">PSD2 SCA Compliance<a class="hash-link" href="#psd2-sca-compliance" title="Direct link to heading">​</a></h2><p>Strong Customer Authentication (SCA) is a requirement of the second Payment Services Directive (PSD2) in the European Economic Area (EEA), Monaco, and the United Kingdom. It aims to add extra layers of security to e-commerce payments by requiring banks to perform additional checks when Customers make payments.</p><p>PSD2 is for banks, not for merchants. This means that to comply with the law in their home country, banks must refuse non-compliant payments. To avoid the risk of the bank declining your payment, you as a merchant need to ensure that your payments comply with PSD2 SCA regulations.</p><p>You can comply by obtaining additional authentication to verify the Customer’s identity or by providing a valid reason for the payment to be exempt from SCA. Any authentication must use a least two of the following three elements:</p><ol><li>Something the Customer knows (eg password)</li><li>Something the Customer has (eg phone)</li><li>Something the Customer is (eg fingerprint)</li></ol><p>PSD2 countries are: Austria, Belgium, Bulgaria, Croatia, Republic of Cyprus, Czech Republic, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Iceland, Ireland, Italy, Latvia, Liechtenstein, Lithuania, Luxembourg, Malta, Monaco, Netherlands, Norway, Poland, Portugal, Romania, Slovakia, Slovenia, Spain, Sweden, and the UK.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="obtaining-strong-customer-authentication">Obtaining Strong Customer Authentication<a class="hash-link" href="#obtaining-strong-customer-authentication" title="Direct link to heading">​</a></h3><p>Strong Customer Authentication applies to Customer entered online transactions (ECOM). Mail Order/Telephone Order (MOTO) transactions and recurring transactions are considered Merchant entered transactions and do not require strong authentication.</p><p>Currently, the most common way of authenticating an online card payment is to use 3-D Secure. 3-D Secure is accepted as a means of obtaining Cardholder authentication for the purposes of SCA.</p><p>Other card-based payment method such as Apple Pay and some Google Pay payments already support payment flows with a built-in layer of strong authentication (biometric or password). These can be a great way for you to offer a frictionless checkout experience while meeting the new requirements.</p><p>We also expect many alternative European payment methods such as PayPal, Amazon Pay, iDEAL, etc. to follow the new SCA rules without any major changes to their user experience.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sca-soft-declines">SCA Soft-Declines<a class="hash-link" href="#sca-soft-declines" title="Direct link to heading">​</a></h3><p>There are two main types of card transaction declines: hard declines and soft declines.</p><p>Hard declines happen when the issuing bank rejects the transaction. Examples include attempting to use a card that has been reported lost or stolen, or the card has expired. Hard declines are permanent, so the payment should not be retried.</p><p>Soft declines are temporary authorisation failures. Around 80% to 90% of all declines fall into this category. They occur for a host of reasons including the need to authenticate the Cardholder further or because there are issues with the technical infrastructures that process the transaction. Soft declines are temporary, meaning you can process the transaction again after meeting the requirements that led to the decline the first time around.</p><p>If you do not obtain SCA on an eligible payment the issuer may soft decline the payment insisting that SCA be obtained. In which case a <code>responseCode</code> of 65 will be returned by the Gateway and you can choose to resubmit the payment with SCA if required.</p><p>With the Handpoint Gateway you can use 3-D Secure to obtain SCA and automatically retry payments that have been soft declined for this reason. If 3-D Secure has been used to provide SCA and the issuer still declines insisting that SCA be obtained, then the Gateway will return a normal decline <code>responseCode</code> of 5 to prevent an infinite loop of obtaining SCA and then being declined for lack of SCA.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaExemptions">Exemptions to Strong Customer Authentication<a class="hash-link" href="#scaExemptions" title="Direct link to heading">​</a></h3><p>There are some e-commerce transactions which are out of scope of the regulation, and others that may be exempt.</p><p>Obtaining Strong Customer Authentication can add friction and increase Customer drop-off and therefore you should make use of exemptions to reduce the number of times you will need to authenticate a Customer.</p><p>However, the bank has the right to refuse any requested exemption and decline the payment insisting that SCA be obtained. The following exemptions are available:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="mail-order--telephone-order-payments">Mail Order / Telephone Order Payments<a class="hash-link" href="#mail-order--telephone-order-payments" title="Direct link to heading">​</a></h4><p>Card details collected via mail or over the phone (MOTO) fall outside of the scope of SCA and do not require authentication. You can flag such payments by passing a value of ‘2’ in the <code>type</code> request field.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="merchant-initiated-transactions-including-recurring-transactions">Merchant Initiated Transactions (including recurring transactions)<a class="hash-link" href="#merchant-initiated-transactions-including-recurring-transactions" title="Direct link to heading">​</a></h4><p>Payments made with saved cards when the Customer is not present in the payment flow may qualify as <a href="/hostedpaymentfields/credentialsonfile#mit">Merchant Initiated Transactions</a>. These payments fall outside of the scope of SCA however it is still up to the bank to decide whether authentication is needed for the payment.</p><p>The initial payment that saved the card will still need to have obtained SCA or be exempt and agreement must be obtained from the Customer to charge their card at a later point.</p><p>You can flag such payments by passing a value of ‘9’ (Continuous Authority) in the <code>type</code> request field or using an <code>rtAgreementType</code> that signifies the transaction as being Merchant Initiated.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="low-value-exemption">Low Value Exemption<a class="hash-link" href="#low-value-exemption" title="Direct link to heading">​</a></h4><p>Payments below €30 are considered low value and are generally exempt from authentication. However, if the Customer initiates more than five consecutive low value payments or if the total payments value exceeds €100) then SCA will be required.</p><p>You can request this exemption by passing a value of ‘lowvalue’ in the <code>scaExemption</code> request field, or it may be automatically applied by the Issuer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="trusted-beneficiary-exemption">Trusted Beneficiary Exemption<a class="hash-link" href="#trusted-beneficiary-exemption" title="Direct link to heading">​</a></h4><p>The Customer can opt to trust you as a Merchant during their first authentication, then subsequent payments with you are likely to be exempt from future SCA.</p><p>You can request this exemption by passing a value of ‘trusted’ in the <code>scaExemption</code> request field to allow this trust to be taken into consideration.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="trusted-risk-analysis-tra-exemption">Trusted Risk Analysis (TRA) Exemption<a class="hash-link" href="#trusted-risk-analysis-tra-exemption" title="Direct link to heading">​</a></h4><p>If the payment provider, having in place effective risk analysis tools, assesses that the fraud risk associated with the payment is low then they can allow this exemption.</p><p>You can request this exemption by passing a value of ‘risk’ in the <code>scaExemption</code> request field if agreed to by the payment provider.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="secured-corporate-payment-exemption">Secured Corporate Payment Exemption<a class="hash-link" href="#secured-corporate-payment-exemption" title="Direct link to heading">​</a></h4><p>Payments initiated by a business rather than a Consumer and processed through a secured dedicated payment protocol can be exempt from SCA provided alternative controls are sufficiently secure.</p><p>You can request this exemption by passing a value of ‘corporate’ in the <code>scaExemption</code> request field to indicate such a secure transaction.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="delegated-authentication-exemption">Delegated Authentication Exemption<a class="hash-link" href="#delegated-authentication-exemption" title="Direct link to heading">​</a></h4><p>If you already require your Customers to perform sufficient authentication on your website, such as secure account logins etc., then you can use this exemption to request that further SCA is not required.</p><p>You can request this exemption by passing a value of ‘delegated’ in the <code>scaExemption</code> request field to indicate such a secure transaction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaUsing3dSecure">SCA Using 3-D Secure<a class="hash-link" href="#scaUsing3dSecure" title="Direct link to heading">​</a></h3><p>3-D Secure can be used to provide the necessary Strong Customer Authentication. You have a choice of how and when to use 3-D Secure to satisfy SCA:</p><p><strong>Authentication Before Authorisation</strong>
You submit payments using 3-D Secure for authentication up front so that the authorisation will be submitted to the Acquirer with the appropriate authentication data showing that SCA was sought. You may pass an exemption indicator (an exemption can be explicitly requested using the <code>scaExemption</code> field) causing the Gateway to automatically request a frictionless flow (the Gateway will use the correct ‘requestorChallengeIndicator’ unless overridden by any value passed in the request).</p><p><strong>Authentication After Authorisation, when requested by the Issuer (Bypass)</strong>
You submit payments without 3-D Secure authentication but with an exemption indicator (an exemption can be explicitly requested using the <code>scaExemption</code> field), if required, and the authorisation will be submitted to the Acquirer with no authentication data. If the Issuer approves the authorisation, then no further additional authentication is needed. However, if the Issuer refuses the authorisation due to SCA being required (the issuer will soft decline the transaction indicating SCA is required) then transaction can be repeated but this time using 3-D Secure (you are advised to send a <code>threeDSOptions</code> ‘requestorChallengeIndicator’ value of 4 to mandate a challenge) and no exception indicator.</p><p>The Gateway can support both choices and in the case of the second choice it can automatically perform the repeat transaction on your behalf.</p><p>The choice of how and when authentication is performed is indicated by selecting a 3-D Secure Policy in the Merchant Management System or by sending the <code>threeDSPolicy</code> field in the request.</p><p>The policies available are:</p><ol><li>Authenticate Before Authorisation or When Issuer Requests (Default)</li><li>Authenticate Before Authorisation Only</li><li>Authenticate When Issuer Requests Only (Bypass)</li><li>Authenticate Before Authorisation or When Issuer Requests <!-- -->[PSD2]</li><li>Authenticate Before Authorisation Only <!-- -->[PSD2]</li><li>Authenticate When Issuer Requests Only <!-- -->[PSD2]<!-- --> (Bypass)</li></ol><p>The <!-- -->[PSD2]<!-- --> policies will perform 3-D Secure authentication only if the transaction falls within the jurisdiction of the European Union&#x27;s Payment Services Directive 2, otherwise it will behave as if 3-D Secure had not been required.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3d-secure-overview">3D Secure Overview<a class="hash-link" href="#3d-secure-overview" title="Direct link to heading">​</a></h2><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>The Gateway supports both 3-D Secure version 1 and version 2 and will use the highest version available. Version 2 is also commonly known as EMV 3-D Secure.
3DS Version 2 is now enforced across all Europe and it is therefore <strong>MANDATORY</strong> to support it to prevent a high number of declines. </p></div></div><p>3-D Secure authentication is now a <strong>MANDATORY</strong> fraud prevention scheme in Europe that is on all e-commerce card transactions processed by the Gateway, where supported by the Acquirer.</p><p>It allows the Cardholder to assign a password to their card that is then verified whenever a transaction is processed through a site that supports the use of the scheme. The addition of password protection allows extra security on transactions that are processed online.</p><p>3-D Secure stands for Three Domain Secure. There are 3 parties that are involved in the 3-D Secure process:</p><ul><li>The company from which the purchase is being made.</li><li>The Acquiring Bank (the bank of the company)</li><li>VISA and Mastercard (the card issuers themselves)</li></ul><p>The gateway supports EMV 3-D Secure as implemented by Visa, Mastercard and American Express and marketed under the brand names of Visa Secure, Mastercard ID Check and American Express SafeKey. Implementations by JCB (J/Secure) and DCI (ProtectBuy) are not currently supported.</p><p>The 3-D Secure preferences can be configured per Merchant Account. These preferences can be overridden per transaction by sending one of the preference fields which hold a comma separated list of the check responses that should be allowed to continue to completion. Responses not in the list will result in the transaction being declined with a <code>responseCode</code> of 65803 (3DS_NOT_AUTHENTICATED).</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-benefits">3DS Benefits<a class="hash-link" href="#3ds-benefits" title="Direct link to heading">​</a></h2><ul><li>The results are available immediately and returned as part of the transaction.</li><li>The checks can be managed independently allowing you the utmost control over how the results are used.</li><li>The checks can be configured to decline the transaction automatically, where required..</li><li>There are no extra Gateway costs for using 3-D Secure. Your Acquirer may charge to add this onto your business account; however, you may also find that your transaction charges are lower as a result of using 3-D Secure.</li><li>Fully configurable for each merchant account. </li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-limitations">3DS Limitations<a class="hash-link" href="#3ds-limitations" title="Direct link to heading">​</a></h2><ul><li>The gateway does not support 3-D Secure for JCB or Diner’s club cards.</li><li>3-D Secure transactions require a browser in order to display the Customer authentication dialog.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-implementation">3DS Implementation<a class="hash-link" href="#3ds-implementation" title="Direct link to heading">​</a></h2><p>If your Merchant account is set up for 3-D Secure, the Gateway will require further authentication details provided by the 3-D Secure system.</p><p>The 3-D Secure authentication form is designed and controlled by the Customer’s Issuing bank and will display the Merchant Account name and any website address added when the account was onboarded. You can change the displayed name and website address by sending the <code>merchantName</code> and/or <code>merchantWebsite</code> request fields. Any <code>merchantWebsite</code> must be a fully qualified URL containing at least the scheme and host components.</p><p>You may also pass additional information about the transaction and Cardholder, using the <code>threeDSOptions</code> field. This extra information can help the Issuer decide on whether a challenge is required.</p><p>Your Merchant Account must be configured with your Merchant Category Code (MCC). This value is usually configured in the backend but can also be provided in the request using the <code>merchantCategoryCode</code> or <code>threeDSOptions</code> fields.</p><p>You will need to implement a callback page on your web server which the 3-D Secure Access Control Server (ACS) can redirect the Cardholder’s browser to on completion of any challenges. You will need to provide the address of this page to the Gateway in your initial payment request via the <code>threeDSRedirectURL</code> field.</p><p>The direct integration uses two complex fields to pass data between the 3-D Secure Access Control Server (ACS) and the Gateway. The <code>threeDSRequest</code> is a record whose name/value properties must be sent via a HTTP POST request to the ACS. The corresponding <code>threeDSResponse</code> field should be returned to the Gateway and must be a record containing name/value properties taken from the HTTP POST received from the ACS when it redirects the Cardholder’s browser back to your callback page on completion of any challenge.</p><p>Note that the contents of the <code>threeDSRequest</code> and <code>threeDSResponse</code> fields are formatted using the record format detailed in section <a href="/hostedpaymentfields/overview#fieldFormats">field formats</a> and their contents should be regarded as opaque and all name/value pairs received from the Gateway must be sent to the ACS, and vice versa. The Gateway does not currently support these fields to be provided in the serialised record format.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="request-flow">Request Flow<a class="hash-link" href="#request-flow" title="Direct link to heading">​</a></h2><p>Each step of the 3-D Secure flow is described below. At a high level it consists of a secure conversation between the Customer’s issuing bank and the Acquiring bank, facilitated by both the Merchant and the Gateway, in the form of several challenges. Each step of this conversation may contain a visible or invisible challenge. A 3-D Secure authentication form represents a visible challenge. An invisible challenge may be presented in the form of a Device Fingerprinting Method. The bank controls the number of challenges each transaction requires, and some transactions may be sufficiently trusted to require zero challenges. Because of this, your implementation will need to loop through multiple possible Continuation Requests, thus continuing the 3-D Secure process until you have received a message from the Gateway informing you that the 3-D Secure process has been completed.</p><p> <img loading="lazy" alt="Direct integration Flow" src="/assets/images/direct-integration-flow-80f8c7304ab0dc560781c8051a8c0336.png" width="786" height="871" class="img_ev3q"></p><ul><li><p><strong>Step 1: Initial Request</strong></p><p>Your Cardholder has just pressed ‘submit’ on your payment form. You now start the payment process with a SALE request to the Gateway. You should send an initial request to the Gateway containing the payment details, device details and any required <code>threeDSOptions</code>. This request must include your callback page, as described above, in the <code>threeDSRedirectURL</code> field.</p></li><li><p><strong>Step 2: Initial Response</strong></p><p>We check basic factors relating to the card being charged and respond with a determination of whether 3-D Secure is needed on this transaction. <em>Note: this process is influenced by third parties and not totally within the Gateway’s control.</em>
If no 3-D Secure challenge is required, the Gateway will respond with a transaction completion status using one of our standard codes.
However, if 3-D Secure challenge is required, the Gateway will respond with a <code>responseCode</code> of 65802, and the response will include a transaction reference called <code>threeDSRef</code>, an array of data called <code>threeDSRequest</code>, and the URL for the Access Control Server (ACS) called <code>threeDSURL</code>. You will need to save the <code>threeDSRef</code> as it will be needed in step 4.</p></li><li><p><strong>Step 3: Device Method Request</strong></p><p>If 3DS device fingerprinting is required, send the contents of the <code>threeDSRequest</code> to the <code>threeDSURL</code> as received in step 2. This should be done in the Cardholder’s browser using an HTTP POST method.</p></li><li><p><strong>Step 4: Method (Continuation) Request</strong></p><p>The ACS will respond with method data. The Gateway now needs this data to continue with the transaction.Please relay this data to the Gateway, including the relevant <code>threeDSRef</code> provided in step 2.
If the method response was sufficient to allow the card to be authorised without a challenge, you will receive a transaction complete response, with an authorisation code.</p></li><li><p><strong>Step 5: Challenge Response / Final Response</strong></p><p>If the Gateway responds with a further <code>responseCode</code> of 65802, send the contents of the <code>threeDSRequest</code> to the <code>threeDSURL</code> as explained in step 2. This should be done in the Cardholder’s browser using an HTTP POST method.</p></li><li><p><strong>Step 6: Challenge (Continuation) Request</strong></p><p>Once you have received a Challenge Response from the ACS, please relay this data to the Gateway, including the relevant <code>threeDSRef</code> provided in step 5.</p></li><li><p><strong>Step 7: Final Response</strong></p><p>You might have noticed that steps 3-6 were remarkably similar. It is in fact the same implementation, repeated. We recommend creating a loop to handle these similar messages as continuations of the same process, then simply ending the loop when you receive a Final Response.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="initial3dSecureRequest">Initial Request (Verify Enrolment)<a class="hash-link" href="#initial3dSecureRequest" title="Direct link to heading">​</a></h3><p>If no 3-D Secure authentication details are provided in the initial request, the Gateway will determine if the transaction is eligible for 3-D Secure by checking whether the card is enrolled in the 3-D Secure scheme.</p><p>If the Gateway determines that the transaction is not eligible for 3-D Secure, then it will continue to process it as a normal transaction without 3-D Secure, unless the <code>threeDSRequired</code> request field indicates that the transaction should be aborted instead.</p><p>To support 3-D Secure, you must pass the <code>threeDSRedirectURL</code> field in the initial request. This field must contain the complete URL to a web page on your server that the 3-D Secure Access Control Server (ACS) will HTTP POST the authentication results back to, when the authentication has been completed.</p><p>You must also provide details about the Cardholder’s device, using the fields documented in <a href="/hostedpaymentfields/advanceddata#deviceInformationFields">device information fields</a> or using the associated options in the <code>threeDSOptions</code> field. You may also use the <code>threeDSOptions</code> field to pass additional information about the transaction and Cardholder, which can help the Issuer decide on whether a challenge is required.</p><p>If the Gateway determines that the transaction is eligible, it will respond with a responseCode of 65802 (3DS AUTHENTICATION REQUIRED) and included in the response will be a <code>threeDSRef</code> field, a <code>threeDSRequest</code> field and a <code>threeDSURL</code> field.</p><p>The <code>threeDSRequest</code> field is a record whose name/value properties must be sent, using a HTTP POST request, to the 3-D Secure Access Control Server (ACS) at the URL provided by the <code>threeDSURL</code> field. This is usually achieved via means of a hidden HTML input fields in a form rendered within an IFRAME displayed on the Cardholder’s browser and then submitted using JavaScript. The IFRAME must be of sufficient size to display the challenge screen, however, if the <code>threeDSRequest</code> contains a <code>threeDSMethodData</code> component, then the challenge is invisible, and a small hidden IFRAME can be used instead.
You must store the value of the <code>threeDSRef</code> field for use in the continuation request.</p><p>These fields should be sent in addition to basic request fields detailed in the <a href="/hostedpaymentfields/transactiontypes/#transactionRequest">transaction types</a> section: </p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>threeDSRedirectURL</td><td><span class="badge badge--primary">Yes</span></td><td>A URL on the Merchant’s server to which the ACS can POST the challenge results, thus redirecting the challenge IFRAME to this page.</td></tr><tr><td>threeDSOptions</td><td><span class="badge badge--primary">Conditional</span></td><td>Record containing 3DS options that can be used by the ACS for advance fraud checking. Some browser configuration options are <strong>mandatory</strong> if the corresponding device detail fields are not provided. Refer to <a href="#3dsOptions">3DS Options</a> for more details.</td></tr><tr><td>merchantName</td><td>No</td><td>Merchant name to use on 3DS challenge form. <br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>merchantWebsite</td><td>No</td><td>Merchant website to use on 3DS challenge form. The website must be a fully qualified URL and include at least the scheme and host components.<br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>merchantCategoryCode</td><td>No</td><td>Merchant category code.</td></tr><tr><td>threeDSRequired</td><td>No</td><td>Is 3DS required for this transaction? <br><br>Possible values are:<br> N – 3DS is not required.  <br>Y – Abort if 3DS is not enabled<br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>threeDSCheckPref</td><td>No</td><td>List of <code>threeDSCheck</code> response values that are to be accepted, any other value will cause the transaction to be declined. <br><br>Value is a comma separated list containing one or more of the following values: ‘not known&#x27;, &#x27;not checked&#x27;, &#x27; not authenticated&#x27;, &#x27;attempted authentication&#x27;, &#x27;authenticated’.<br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>threeDSPolicy</td><td>No</td><td>3DS Policy used. Refer to <a href="#scaUsing3dSecure">SCA Using 3-D Secure</a>.<br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>threeDSVersion</td><td>No</td><td>Force a particular version to be used rather than using the highest available for the transaction details. <strong>Use of this request field is not encouraged under normal circumstances.</strong><br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr><tr><td>scaExemption</td><td>No</td><td>An SCA exemption can be used to request that a frictionless flow is preferable. Refer to <a href="#scaExemptions">Exemptions to Strong Customer Authentication</a>.<br><br>Overrides any Merchant Account setting configured via the Merchant Management System (MMS).</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3dSecurecontinuationRequest">Continuation Request (Check Authentication and Authorise)<a class="hash-link" href="#3dSecurecontinuationRequest" title="Direct link to heading">​</a></h3><p>On completion of the 3-D Secure authentication the ACS will send the challenge results to you callback page, as originally specified using the <code>threeDSRedirectURL</code> field in the initial request.</p><p>The data will be received via means of a HTTP POST request and the contents of this POST request should be returned to the Gateway unmodified as name/value properties in the <code>threeDSResponse</code> field together with the <code>threeDSRef</code> received in the initial response.</p><p>This new request will check the authentication results and either respond with the details for a further challenge, send the transaction to the Acquirer for approval, or abort the transaction, depending on the authentication result and your preferences, either sent in the threeDSCheckPref field or set in the Merchant Management System (MMS).</p><p>These fields may be sent alone: </p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>threeDSRef</td><td>Yes</td><td>The value of the <code>threeDSRef</code> field in the initial Gateway response.</td></tr><tr><td>threeDSResponse</td><td>Yes</td><td>The data POSTed back from the ACS when the challenge has completed.</td></tr></tbody></table><p>Note: It is only necessary to send the <code>threeDSRef</code> and the <code>threeDSResponse</code> in the continuation request, because the threeDSRef will identify the Merchant Account and initial request. The message does not need to be signed. However, you can send any of the normal request fields to modify or supplement the initial request. Any card details and transaction amount sent in the second request must match those used in the first request, else the second request will fail with a responseCode of 64442 (REQUEST MISMATCH).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="multiple-challenges-and-frictionless-flow">Multiple Challenges and Frictionless Flow<a class="hash-link" href="#multiple-challenges-and-frictionless-flow" title="Direct link to heading">​</a></h3><p>The API supports the issuing of multiple challenges where the continuation request may indicate the requirement to perform another challenge by responding with a <code>responseCode</code> of 65802 (3DS AUTHENTICATION REQUIRED) and including a further <code>threeDSRequest</code>, <code>threeDSURL</code> and <code>threeDSRef</code>. When this happens, these further challenge details should be treated the same as the first and POSTed to the ACS.</p><p>An initial device fingerprinting method might have to be invoked on the ACS, the results of which are used to determine whether the Cardholder must complete a challenge or whether a frictionless flow can be achieved where the transaction can continue unchallenged.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cardholder-challenge">Cardholder Challenge<a class="hash-link" href="#cardholder-challenge" title="Direct link to heading">​</a></h3><p>The Cardholder challenge takes place with the Cardholder’s browser, usually within an IFRAME embedded on the payment form. To start the challenge, the IFRAME should contain a HTML FORM with hidden INPUT fields storing the name/value pairs returned in the <code>threeDSRequest</code> record. JavaScript should then be used to submit the form automatically, causing the form data to be sent via a HTTP POST to the <code>threeDSURL</code>.</p><p>The IFRAME should be of sufficient size to display the ACS challenge form. The challenge form supports a limited number of different sizes, giving the Merchant more flexibility in the design of their payment form. The required size can be set using the ‘challengeWindowSize’ option, passed in the <code>threeDSOptions</code> field in the initial request.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="device-fingerprinting-challenge">Device Fingerprinting Challenge<a class="hash-link" href="#device-fingerprinting-challenge" title="Direct link to heading">​</a></h3><p>The device fingerprinting method invocation is handled in the same way as a normal Cardholder challenge, except that it can be done silently in a hidden IFRAME, invisible to the normal payment flow. This silent device fingerprinting method request can be determined by the presence of a <code>threeDSMethodData</code> element in the <code>threeDSRequest</code> record (this is one time when the normally opaque data does need to be checked).</p><p>This method should take no longer than 10 seconds and therefore if the ACS has not POSTed the results back within 10 seconds, then the browser can stop waiting and the transaction can be continued as normal but the <code>threeDSResponse</code> field should be returned indicating the timeout by including a <code>threeDSMethodData</code> element with the value of &#x27;timeout&#x27;, for example, “threeDSResponse<!-- -->[threeDSMethodData]<!-- -->=timeout”</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3dSecureChallengeResponse">Challenge Response<a class="hash-link" href="#3dSecureChallengeResponse" title="Direct link to heading">​</a></h3><p>These fields are returned when a 3-D Secure challenge is required and provide the information necessary for you to request the Access Control Server (ACS) perform that challenge.</p><p>These fields will be returned in addition to the <a href="#initial3dSecureRequest">3D secure request fields</a> and the <a href="/hostedpaymentfields/transactiontypes#transactionResponse">basic response fields</a>.</p><table><thead><tr><th>Name</th><th>Returned</th><th>Description</th></tr></thead><tbody><tr><td>threeDSEnabled</td><td>Always</td><td>Is 3DS enabled for this Merchant Account?<br><br> Possible values are:<br> N – Merchant Account is not enabled.<br> Y – Merchant Account is enabled.</td></tr><tr><td>threeDSPolicy</td><td>If 3DS enabled</td><td>3DS Policy used. Refer to <a href="#scaUsing3dSecure">SCA using 3-D Secure</a> for more details.</td></tr><tr><td>threeDSVETimestamp</td><td>If 3DS enabled</td><td>The time the card was checked for 3DS enrolment, and any initial challenge determined.</td></tr><tr><td>threeDSEnrolled</td><td>If 3DS enabled</td><td>The 3DS enrolment status for the credit card. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details. <br> <br> Possible values are:<br>  Y – Enrolled. <br> N – Not enrolled.<br>  U – Unable to verify if enrolled.<br> E – Error verifying enrolment.</td></tr><tr><td>threeDSRef</td><td>If 3DS enabled</td><td>Value to return in the continuation request.</td></tr><tr><td>threeDSURL</td><td>If 3DS enrolled</td><td>The URL of the ACS to which the challenge data should be sent via a HTTP POST request from the Cardholder’s browser.</td></tr><tr><td>threeDSRequest</td><td>If 3DS enrolled</td><td>Record containing the name/value pairs that should be sent to the ACS via HTTP POST request from the Cardholder’s browser.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="final-response">Final Response<a class="hash-link" href="#final-response" title="Direct link to heading">​</a></h3><p>These fields are returned when the 3-D Secure stage has completed, and no further challenge is required.
These fields will be returned in addition to the <a href="#initial3dSecureRequest">3D secure request fields</a>; any <a href="#3dSecurecontinuationRequest">continuation request fields</a>; any <a href="#3dSecureChallengeResponse">challenge response fields</a>; and the <a href="/hostedpaymentfields/transactiontypes#transactionResponse">basic response fields</a>.</p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>threeDSEnabled</td><td>Always</td><td>Is 3DS enabled for this Merchant Account?<br><br> Possible values are:<br> N – Merchant Account is not enabled.<br> Y – Merchant Account is enabled.</td></tr><tr><td>threeDSPolicy</td><td>If available</td><td>3DS Policy used. Refer to <a href="#scaUsing3dSecure">SCA using 3-D Secure</a> for more details.</td></tr><tr><td>threeDSXID</td><td>If 3DS enabled</td><td>The unique identifier for the transaction in the 3DS system.</td></tr><tr><td>threeDSVETimestamp</td><td>If 3DS enabled</td><td>The time the card was checked for 3DS enrolment, and any initial challenge determined.</td></tr><tr><td>threeDSEnrolled</td><td>If 3DS enabled</td><td>The 3DS enrolment status for the credit card. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details. <br><br>Possible values are:<br> Y – Enrolled. <br>N – Not enrolled.<br> U – Unable to verify if enrolled. <br>E – Error verifying enrolment.</td></tr><tr><td>threeDSCATimestamp</td><td>If 3DS enabled</td><td>The time the last challenge was checked.</td></tr><tr><td>threeDSAuthenticated</td><td>If 3DS enabled</td><td>The 3DS authentication status for the credit card. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.<br><br> Possible values are:<br> Y – Authenticated. <br>A – Attempted to authenticate. <br>N – Not authenticated. <br>R – Reject transaction.<br> I – Information only.<br> U – Unable to authenticate.<br> E – Error checking authentication.</td></tr><tr><td>threeDSECI</td><td>If 3DS authenticated</td><td>This contains a two-digit Electronic Commerce Indicator (ECI) value. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details. The data contained within this property is only valid if the threeDSAuthenticated value is Y or A.</td></tr><tr><td>threeDSCAVV</td><td>If 3DS authenticated</td><td>This contains a 28-character Base-64 encoded Cardholder Authentication Verification Value (CAVV). Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details. The data contained within this property is only valid if the threeDSAuthenticated value is Y or A.</td></tr><tr><td>threeDSDetails</td><td>If 3DS authenticated</td><td>Record containing further details about the 3-D Secure processing stage. Notable sub fields are:<br>version – 3-D Secure version used <br>versions – 3-D Secure versions available <br>psd2Region – whether payment in PSD2 jurisdiction</td></tr><tr><td>threeDSErrorCode</td><td>If 3DS error</td><td>Any error response code returned by the ACS if there is an error in determining the card’s 3DS status.</td></tr><tr><td>threeDSErrorDescription</td><td>If 3DS error</td><td>Any error response description returned by the ACS if there is an error in determining the card&#x27;s 3DS status.</td></tr><tr><td>threeDSResponseCode</td><td>Always</td><td>A numeric code providing the specific outcome of the 3-D Secure processing stage. Check threeDSResponseMessage for more details of any error that occurred. Refer to <a href="/hostedpaymentfields/annexes#3dsecureErrorCodes">Response Codes</a> for more details.</td></tr><tr><td>threeDSResponseMessage</td><td>Always</td><td>Any error message relating to the outcome of the 3-D Secure processing stage.</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="externalAuthRequest">External Authentication Request<a class="hash-link" href="#externalAuthRequest" title="Direct link to heading">​</a></h3><p>You can choose to obtain the 3-D Secure authentication details from a third-party, in which case you should provide them as part of a standard request. If the Gateway receives valid third-party authentication details, then it will use those and not attempt to perform the 3-D Secure challenge flow.</p><p>These fields should be sent in addition to basic request fields detailed in the <a href="/hostedpaymentfields/transactiontypes/#transactionRequest">transaction types</a> section: </p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>threeDSEnrolled</td><td>If 3DS enabled</td><td>The 3DS enrolment status for the credit card. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.<br><br>Possible values are: <br>Y – Enrolled. <br>N – Not enrolled.<br>U – Unable to verify if enrolled. <br>E – Error verifying enrolment.</td></tr><tr><td>threeDSAuthenticated</td><td>If 3DS enrolled</td><td>The 3DS authentication status for the credit card. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.<br><br>Possible values are: <br>Y – Authenticated.<br>A – Attempted to authenticate.<br>N – Not authenticated.<br>I – Information only.<br>U – Unable to authenticate<br>E – Error checking authentication.</td></tr><tr><td>threeDSXID</td><td>If 3DS authenticated</td><td>The unique identifier for the transaction in the 3DS system. Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.</td></tr><tr><td>threeDSECI</td><td>If 3DS authenticated</td><td>The Electronic Commerce Indicator (ECI). Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.</td></tr><tr><td>threeDSCAVV</td><td>If 3DS authenticated</td><td>The Cardholder Authentication Verification Value (CAVV). Refer to <a href="#3dSecureAuthenticationData">3-D Secure Authentication Data</a> for details.</td></tr></tbody></table><p>Note: If 3-D Secure is not enabled for the Merchant Account, then any 3-D Secure authentication fields sent in the request are ignored and the transaction is processed as normal without 3-D Secure.</p><p>When an external 3-D Secure provider is used then you are responsible for deciding whether to continue at the different 3-D Secure stages and any preferences provided in the merchant management system (MMS) or using the threeDSCheckPref request field are ignored.</p><p>If the external provider returns an authentication status of ‘R’ then you must not continue with the transaction either with or without 3-D Secure. Do not attempt to send a <code>threeDSAuthentication</code> status of ‘R’ expecting the Gateway to reject the transaction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="external-authentication-response">External Authentication Response<a class="hash-link" href="#external-authentication-response" title="Direct link to heading">​</a></h3><p>These fields will be returned in addition to the <a href="#externalAuthRequest">external authentication request fields</a> and the <a href="/hostedpaymentfields/transactiontypes#transactionResponse">basic response fields</a>.</p><table><thead><tr><th>Name</th><th>Returned</th><th>Description</th></tr></thead><tbody><tr><td>threeDSEnabled</td><td>Always</td><td>Is 3DS enabled for this Merchant Account?<br><br> Possible values are:<br> N – Merchant Account is not enabled.<br> Y – Merchant Account is enabled.</td></tr></tbody></table><p>Note: If 3-D Secure is not enabled for the Merchant Account, then any 3-D Secure authentication fields sent in the request are ignored and the transaction is processed as normal without 3-D Secure.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cardholder-information">Cardholder Information<a class="hash-link" href="#cardholder-information" title="Direct link to heading">​</a></h3><p>In the case of a frictionless flow, the card Issuer may sometimes wish to provide a message to the Cardholder. In this case, the <code>threeDSResponseMessage</code> will start with the text ‘Cardholder Info: ‘ and be followed by the message from the card Issuer.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="psd2-strong-customer-authentication">PSD2 Strong Customer Authentication<a class="hash-link" href="#psd2-strong-customer-authentication" title="Direct link to heading">​</a></h3><p>3-D Secure can be used to provide the Strong Customer Authentication (SCA) required by the European Union&#x27;s Payment Services Directive 2 (PSD2).
For more details on how to use 3-D Secure to maintain PSD2 SCA Compliance please refer to Refer to <a href="#scaUsing3dSecure">SCA Using 3-D Secure</a>. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3dsOptions">3DS Options<a class="hash-link" href="#3dsOptions" title="Direct link to heading">​</a></h2><p>The following options may be sent in the <code>threeDSOptions</code> field to provide additional information to help customise the 3-D Secure experience or to help the ACS decide if a challenge is required.</p><p>Some additional information will be automatically provided by the Gateway from standard integration fields unless overridden by providing the associated option. The standard integration field associated with each option is shown in brackets below the options field name. The standard integration field should be used rather than the option, apart from the very rare circumstances where the two must have different values.</p><p>A few additional information values, such as the Cardholder’s browser details, are mandatory and therefore either the standard integration field or the option must be provided. These fields are marked as ‘Yes’ in the Mandatory column of the table below.</p><p>Some 3-D Secure information is mandatory and must be provided using the following <code>threeDSOptions</code> field or preferably using the associated standard integration field, in brackets, apart from the very rare circumstances where the two must have different values.</p><p><strong>If this mandatory information is not available, then 3-D Secure will fail.</strong></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>The following information is mandatory:</p><ul><li>requestorName (merchantName) <strong>we will use the default stored on file - no need to pass it as part of the threeDSOptions</strong></li><li>requestorURL (merchantWebsite) <strong>we will use the default stored on file - no need to pass it as part of the threeDSOptions</strong></li><li>merchantCategoryCode (merchantCategoryCode) <strong>we will use the default stored on file - no need to pass it as part of the threeDSOptions</strong></li><li>browserIPAddress (remoteAddress)</li><li>browserUserAgent (deviceIdentity)</li><li>browserAcceptHeader (deviceAcceptContent)</li><li>browserLanguage (deviceAcceptLanguage)</li></ul><p>If the browserJavaScriptEnabled (deviceCapabilites) field is provided and indicates that JavaScript is enabled on the Cardholder’s browser, then the following information is also mandatory:</p><ul><li>browserScreenColourDepth/browserScreenColorDepth (deviceScreenResolution)</li><li>browserScreenWidth (deviceScreenResolution)</li><li>browserScreenHeight (deviceScreenResolution)</li><li>browserTimeZone (deviceTimeZone)</li></ul></div></div><p>The options must be formatted using the record or serialised record formats detailed in the <a href="/hostedpaymentfields/overview#fieldFormats">format guide</a>.</p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>browserAcceptHeader (deviceAcceptContent)</td><td><span class="badge badge--primary">Yes</span></td><td>HTTP accept header sent from the Cardholder’s browser.</td></tr><tr><td>browserIPAddress (remoteAddress)</td><td><span class="badge badge--primary">Yes</span></td><td>IP v4 address of the Cardholder’s browser.</td></tr><tr><td>browserJavaEnabled (deviceCapabilities)</td><td><span class="badge badge--primary">Yes</span></td><td>Ability of the Cardholder’s browser to execute Java.<br> <br>Possible values are:<br>  true – browser can execute Java <br> false – browser cannot execute Java<br> <br>Boolean values must be sent as the strings ‘true’ or ‘false’ unless JSON serialisation is used</td></tr><tr><td>browserJavaScriptEnabled (deviceCapabilities)</td><td><span class="badge badge--primary">Yes</span></td><td>Ability of the Cardholder’s browser to execute JavaScript. <br> <br> Possible values are:<br>  true – browser can execute Javascript <br> false – browser cannot execute Javascript<br> <br>Boolean values must be sent as the strings ‘true’ or ‘false’ unless JSON serialisation is used</td></tr><tr><td>browserLanguage (deviceAcceptLanguage)</td><td><span class="badge badge--primary">Yes</span></td><td>The Cardholder’s browser language. The browser language as defined in IETF BCP 47.</td></tr><tr><td>browserScreenColourDepth or browserScreenColorDepth (deviceScreenResolution)</td><td><span class="badge badge--primary">Yes</span></td><td>The screen colour depth of the Cardholder’s browser. A value representing the bit depth of the colour palette, in bits per pixel, for displaying images.<br><br> Possible values are: 1, 4, 8, 15, 16, 24, 32, 48. <br><br> This value is not mandatory if the browser doesn’t support JavaScript.</td></tr><tr><td>browserScreenHeight (deviceScreenResolution)</td><td><span class="badge badge--primary">Yes</span></td><td>The screen height of the Cardholder’s browser.<br><br> This value is not mandatory if the browser doesn’t support JavaScript.</td></tr><tr><td>browserScreenWidth (deviceScreenResolution)</td><td><span class="badge badge--primary">Yes</span></td><td>The screen width of the Cardholder’s browser.<br><br> This value is not mandatory if the browser doesn’t support JavaScript.</td></tr><tr><td>browserTimeZone (deviceTimeZone)</td><td><span class="badge badge--primary">Yes</span></td><td>The difference between UTC time and the cardholder&#x27;s browser local time in minutes.</td></tr><tr><td>browserUserAgent (deviceIdentity)</td><td><span class="badge badge--primary">Yes</span></td><td>The User-Agent header provided by the Cardholder’s browser.</td></tr><tr><td>challengeWindowSize</td><td>No</td><td>The dimensions of the challenge window that has been displayed to the cardholder. The ACS shall reply with content that is formatted to appropriately render in this window to provide the best possible user experience. <br><br>Possible values are: <br>01 – 250 x 400<br> 02 – 390 x 400 (default) <br>03 – 500 x 600<br> 04 – 600 x 400<br> 05 – Full screen</td></tr><tr><td>transactionType</td><td>No</td><td>Identifies the type of transaction being authenticated. This field is required in some markets (eg for Merchants in Brazil).<br> <br> Possible values are: <br> 01 – Goods/ Service Purchase<br>  03 – Check Acceptance <br> 10 – Account Funding <br> 11 – Quasi-Cash Transaction<br>  28 – Prepaid Activation and Load</td></tr><tr><td>cardholderEmail (customerEmail)</td><td>No</td><td>The Cardholder’s email address.</td></tr><tr><td>cardholderHomePhone (customerPhone)</td><td>No</td><td>The Cardholder’s home phone number specified in the following format: “+CountryCode Subscriber” (eg “+44 1234567899”).</td></tr><tr><td>cardholderMobilePhone (customerMobile)</td><td>No</td><td>The Cardholder’s mobile phone number specified in the following format: “+CountryCode Subscriber” (eg “+44 1234567899”).</td></tr><tr><td>cardholderName (customerName)</td><td>No</td><td>Name of the Cardholder. Limited to the alphanumeric characters listed in EMV Book 4, Annex B.</td></tr><tr><td>cardholderWorkPhone</td><td>No</td><td>The Cardholder’s work phone number specified in the following format: “+CountryCode Subscriber” (eg “+44 1234567899”).</td></tr><tr><td>deliveryTimeframe</td><td>No</td><td>Merchandise Delivery Timeframe.<br><br> Possible values are:<br> 01 – Electronic Delivery<br> 02 – Same day shipping<br> 03 – Overnight shipping <br>04 – Two-day or more shipping</td></tr><tr><td>giftCardAmount</td><td>No</td><td>For prepaid or gift card purchase, the purchase amount total of prepaid or gift card(s) in major units (for example, USD 123.45 is 123).</td></tr><tr><td>giftCardCount</td><td>No</td><td>For prepaid or gift card purchase, total count of individual prepaid or gift cards/codes purchased.</td></tr><tr><td>giftCardCurrencyCode</td><td>No</td><td>For prepaid or gift card purchase, the currency code of the card as an ISO 4217 3-digit code or its 3 letter equivalent.</td></tr><tr><td>instalmentPaymentData or installmentPaymentData</td><td>No</td><td>Indicates maximum number of authorizations permitted for instalment payments. Value must be greater than 1.</td></tr><tr><td>merchantCategoryCode (merchantCategoryCode)</td><td>No</td><td>Code describing the Merchant&#x27;s type of business, product, or service.</td></tr><tr><td>merchantCountryCode (countryCode)</td><td>No</td><td>Country code of the merchant as an ISO 3166-1 3-digit code or its 2 or 3 letter equivalents.</td></tr><tr><td>merchantFraudRate</td><td>No</td><td>Merchant’s fraud rate in the EEA (all EEA card fraud divided by all EEA card volumes) calculated as per PSD2 RTS. This value is sent to Mastercard only who will not calculate or validate the fraud score.<br><br> Value will be a numeric value, between 1 and 99, representing the fraud rate, such as:<br> 1 – less than or equal to 1 basis point (bp), which is 0.01%<br> 2 – between 1 bp + - and 6 bps<br> 3 – between 6 bps + - and 13 bps<br> 4 – between 13 bps + - and 25 bps<br> 5 – greater than 25 bps</td></tr><tr><td>merchantName (merchantName)</td><td>No</td><td>Merchant name.</td></tr><tr><td>paymentAccountAge</td><td>No</td><td>Date that the payment account was enrolled in the cardholder&#x27;s account with the 3DS Requestor. Accepted date format is YYYYMMDD.</td></tr><tr><td>paymentAccountAgeIndicator</td><td>No</td><td>Indicates the length of time that the payment account was enrolled in the cardholder&#x27;s account with the 3DS Requestor.<br> Possible values are:<br> 01 – No account (guest check-out)<br> 02 – Created during this transaction<br> 03 – Less than 30 days<br> 04 – 30-60 days<br> 05 – More than 60 days</td></tr><tr><td>preOrderDate</td><td>No</td><td>For a pre-ordered purchase, the expected date that the merchandise will be available. Accepted date format is YYYYMMDD.</td></tr><tr><td>preOrderPurchaseIndicator</td><td>No</td><td>Indicates whether Cardholder is placing an order for merchandise with a future availability or release date.<br><br> Possible values are: <br>01 – Merchandise available<br> 02 – Future availability</td></tr><tr><td>priorAuthData</td><td>No</td><td>Data that documents and supports a specific authentication process.</td></tr><tr><td>priorAuthMethod</td><td>No</td><td>Mechanism used by the Cardholder to previously authenticate to the 3DS Requestor.<br><br> Part of the optional 3DS Requestor Prior Transaction Authentication Information that contains information about a 3DS cardholder authentication that occurred prior to the current transaction.<br><br> Possible values are:<br> 01 – Frictionless authentication occurred by ACS<br> 02 – Cardholder challenge occurred by ACS<br> 03 – ACS verified<br> 04 – Other issuer methods</td></tr><tr><td>priorAuthTimestamp</td><td>No</td><td>Date and time in UTC of the prior cardholder authentication. Accepted date format is YYYYMMDDHHMM.</td></tr><tr><td>priorReference</td><td>No</td><td>Provides additional information to the ACS to determine the best approach for handling a request. It contains an ACS Transaction ID for a prior authenticated transaction (for example, the first recurring transaction that was authenticated with the cardholder).</td></tr><tr><td>recurringExpDate</td><td>No</td><td>This field contains the date after which no further authorizations shall be performed. The format of this field must be: YYYYMMDD.</td></tr><tr><td>recurringFrequency</td><td>No</td><td>This field indicates the minimum number of days between authorizations.</td></tr><tr><td>reorderItemsIndicator</td><td>No</td><td>Indicates whether the cardholder is reordering previously purchased merchandise.<br><br> Possible values are:<br> 01 – First time ordered<br> 02 – Reordered</td></tr><tr><td>reqAuthData</td><td>No</td><td>Data that documents and supports a specific authentication process. In the current version of the specification, this data element is not defined in detail, however the intention is that for each 3DS Requestor Authentication Method, this field carry data that the ACS can use to verify the authentication process.</td></tr><tr><td>reqAuthMethod</td><td>No</td><td>Method used by the Cardholder to authenticate to the 3DS Requestor. <br><br>Part of the 3DS Requestor Authentication Information which contains optional information about how the cardholder authenticated during login to their 3DS Requestor account.<br><br> Possible values are:<br> 01 – No 3DS Requestor authentication occurred (ie cardholder &quot;logged in&quot; as guest) <br>02 – Login to the cardholder account at the 3DS Requestor system using 3DS Requestor&#x27;s own credentials<br> 03 – Login to the cardholder account at the 3DS Requestor system using federated ID <br>04 – Login to the cardholder account at the 3DS Requestor system using issuer credentials <br>05 – Login to the cardholder account at the 3DS Requestor system using third-party authentication<br> 06 – Login to the cardholder account at the 3DS Requestor system using FIDO Authenticator</td></tr><tr><td>reqAuthTimestamp</td><td>No</td><td>Date and time in UTC of the cardholder authentication. Accepted date format is YYYYMMDDHHMM.</td></tr><tr><td>requestorChallengeIndicator</td><td>No</td><td>Indicates whether a challenge is requested for this transaction. For example: you may be using this to obtain SCA and not want to be challenged as you have provided an exemption. This also allows you to request a challenge when adding a card to a wallet or to follow mandates.<br><br> Possible values are: <br>01 – No preference <br>02 – No challenge requested <br>03 – Challenge requested: 3DS Requestor Preference<br> 04 – Challenge requested: Mandate <br>05 – No challenge requested (TRA is already performed)<br> 06 – No challenge requested (data share only) <br>07 – No challenge requested (SCA is already performed) <br>08 – No challenge requested (utilize whitelist exemption) <br>09 – Challenge requested (whitelist prompt requested) <br><br>Values 05 to 09 are for protocol version 2.2.0 but will be accepted for 2.1.0 and 05 to 08 will be downgraded to 02, and 09 to 01. Values 05 to 07 will be passed to Mastercard as part of their &#x27;Merchant Data&#x27; extension. Values 08 and 09 are only valid for protocol version 2.2.0.</td></tr><tr><td>requestorID</td><td>No</td><td>Directory server assigned 3DS Requestor identifier. (Default on file)</td></tr><tr><td>requestorName</td><td>No</td><td>Directory server assigned 3DS Requestor name. (Default on file)</td></tr><tr><td>requestorURL (merchantWebsite)</td><td>No</td><td>3DS Requestor website or customer care site.</td></tr><tr><td>accountAgeIndicator</td><td>No</td><td>Length of time that the cardholder has had the account with the 3DS Requestor.<br><br>  Possible values are:<br>  01 – No account (guest check-out)<br>  02 – Created during this transaction<br>  03 – Less than 30 days<br>  04 – 30-60 days <br> 05 – More than 60 days</td></tr><tr><td>accountChangeDate</td><td>No</td><td>Date that the cardholder&#x27;s account with the 3DS Requestor was last changed. Accepted date format is YYYYMMDD.</td></tr><tr><td>accountChangeIndicator</td><td>No</td><td>Length of time since the cardholder&#x27;s account information with the 3DS Requestor was last changed.<br><br>  Possible values are:<br>  01 – Changed during this transaction.<br>  02 – Less than 30 days<br>  03 – 30-60 days <br> 04 – More than 60 day</td></tr><tr><td>accountDate</td><td>No</td><td>Date that the cardholder opened the account with the 3DS Requestor. Accepted date format is YYYYMMDD.</td></tr><tr><td>accountDayTransactions</td><td>No</td><td>Number of transactions (successful and abandoned) for this cardholder account with the 3DS Requestor across all payment accounts in the previous 24 hours.</td></tr><tr><td>accountId</td><td>No</td><td>Identifier for any Cardholder’s account with the Merchant.</td></tr><tr><td>accountPasswordChangeDate</td><td>No</td><td>Date that cardholder&#x27;s account with the 3DS Requestor had a password change or account reset. Accepted date format is YYYYMMDD.</td></tr><tr><td>accountPasswordChangeIndicator</td><td>No</td><td>Indicates the length of time since the cardholder&#x27;s account with the 3DS Requestor had a password change or account reset. <br><br> Possible values are: <br>01 – No change <br>02 – Changed during this transaction<br> 03 – Less than 30 days<br> 04 – 30-60 days<br> 05 – More than 60 days</td></tr><tr><td>accountProvisioningAttempts</td><td>No</td><td>Number of account provisioning attempts in the last 24 hours.</td></tr><tr><td>accountPurchaseCount</td><td>No</td><td>Number of purchases with this cardholder account during the previous six months.</td></tr><tr><td>accountType</td><td>No</td><td>Indicates the type of account.<br><br> Possible values are:<br> 01 – Not applicable<br> 02 – Credit <br>03 – Debit</td></tr><tr><td>accountYearTransactions</td><td>No</td><td>Number of transactions (successful and abandoned) for this cardholder account with the 3DS Requestor across all payment accounts in the previous year.</td></tr><tr><td>accountYearTransactions</td><td>No</td><td>Number of transactions (successful and abandoned) for this cardholder account with the 3DS Requestor across all payment accounts in the previous year.</td></tr><tr><td>acquirerBIN</td><td>No</td><td>Acquirer bank identification number. (Default on file)</td></tr><tr><td>acquirerCountryCode</td><td>No</td><td>Acquirer country code when the Acquirer country differs from the Merchant country and the Acquirer is in the EEA (this could mean that the transaction is covered by PSD2). (Default on file)</td></tr><tr><td>acquirerMerchantID</td><td>No</td><td>Acquirer-assigned merchant identifier. (Default on file)</td></tr><tr><td>acsChallengeMandatedIndicator</td><td>No</td><td>Indication of whether a challenge is required for the transaction to be authorized due to local/regional mandates or other variables.</td></tr><tr><td>addressMatch</td><td>No</td><td>Indicates to the ACS whether the cardholder shipping address and billing address are the same. <br><br> Possible values are:<br> Y – Shipping address matches billing address.<br> N – Shipping address does not match billing address.</td></tr><tr><td>authenticationIndicator</td><td>No</td><td>Provides additional information to the ACS to determine the best approach for handing an authentication request.<br><br> Possible values are:<br>  01 – Payment - default <br> 02 – Recurring <br> 03 – Instalment<br>  04 – Add Card <br> 05 – Maintain Card <br> 06 – Verify Cardholder<br>  07 – Billing Agreement</td></tr><tr><td>billingAddressCity (customerTown)</td><td>No</td><td>The city of the address. Maximum length is 50 characters.</td></tr><tr><td>billingAddressCountryCode (customerCountryCode)</td><td>No</td><td>The country of the address as an ISO 3166-1 3-digit code or its 2 or 3 letter equivalents.</td></tr><tr><td>billingAddressLine1 (customerAddress)</td><td>No</td><td>The first line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>billingAddressLine2</td><td>No</td><td>The seconf line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>billingAddressLine3</td><td>No</td><td>The third line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>billingAddressPostcode (customerPostcode)</td><td>No</td><td>The ZIP or other postal code of the address. Maximum length is 16 characters.</td></tr><tr><td>billingAddressState</td><td>No</td><td>The state or province of the address as an ISO 3166-2 country subdivision code. Maximum length is 3 characters.</td></tr><tr><td>secureCorporatePaymentIndicator</td><td>No</td><td>Indicates dedicated payment processes and procedures were used, potential secure corporate payment exemption applies.</td></tr><tr><td>serverOperatorID</td><td>No</td><td>3DS Server identifier. (Default on file)</td></tr><tr><td>serverRefNumber</td><td>No</td><td>Assigned server reference number. (Default on file)</td></tr><tr><td>shipAddressUsageDate</td><td>No</td><td>Date when the shipping address used for this transaction was first used with the 3DS Requestor. Accepted date format is YYYYMMDD.</td></tr><tr><td>shipAddressUsageIndicator</td><td>No</td><td>DIndicates the length of time since the shipping address used for this transaction was first used with the 3DS Requestor.<br><br> Possible values are:<br> 01 – This transaction<br> 02 – Less than 30 days <br>03 – 30-60 days<br> 04 – More than 60 days</td></tr><tr><td>shipIndicator</td><td>No</td><td>Indicates shipping method chosen for the transaction. Merchants must choose the Shipping Indicator code that most accurately describes the cardholder&#x27;s specific transaction, not their general business. If one or more items are included in the sale, the Shipping Indicator code for the physical goods is used, or if all digital goods, the Shipping Indicator code that describes the most expensive item. <br><br>Possible values are: <br>01 – Ship to cardholder&#x27;s billing address <br>02 – Ship to another verified address on file with merchant <br>03 – Ship to address that is different than the cardholder&#x27;s billing address <br>04 – &quot;Ship to Store&quot; / Pick-up at local store (Store address shall be populated in shipping address fields)<br> 05 – Digital goods (includes online services, electronic gift cards and redemption codes)<br> 06 – Travel and Event tickets, not shipped <br>07 – Other (for example, Gaming, digital services not shipped, emedia subscriptions, etc.)</td></tr><tr><td>shipNameIndicator</td><td>No</td><td>Indicates if the Cardholder Name on the account is identical to the shipping Name used for this transaction.<br><br> Possible values are:<br> 01 – Account Name identical to shipping Name <br>02 – Account Name different than shipping Name</td></tr><tr><td>shippingAddressCity (deliveryTown)</td><td>No</td><td>The city of the address. The maximum length is 50 characters.</td></tr><tr><td>shippingAddressCountryCode (deliveryCountryCode)</td><td>No</td><td>The country of the address as an ISO 3166-1 3-digit code or its 2 or 3 letter equivalents.</td></tr><tr><td>shippingAddressLine1 (deliveryAddress)</td><td>No</td><td>The first line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>shippingAddressLine2</td><td>No</td><td>The second line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>shippingAddressLine3</td><td>No</td><td>The third line of the street address or equivalent local portion of the address. Maximum length is 50 characters.</td></tr><tr><td>shippingAddressPostcode (deliveryPostcode)</td><td>No</td><td>The ZIP or other postal code of the address. Maximum length is 16 characters.</td></tr><tr><td>shippingAddressState</td><td>No</td><td>The state or province of the address as an ISO 3166-2 country subdivision code. Maximum length is 3 characters.</td></tr><tr><td>suspiciousAccountActivity</td><td>No</td><td>Indicates whether the 3DS Requestor has experienced suspicious activity (including previous fraud) on the cardholder account.<br> <br>  Possible values are:<br>  01 – No suspicious activity has been observed <br> 02 – Suspicious activity has been observed</td></tr><tr><td>whitelistStatus</td><td>No</td><td>Whitelist status. <br><br>Possible values are: <br>Y – 3DS Requestor is whitelisted by cardholder<br> N – 3DS Requestor is not whitelisted by cardholder</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3dSecureAuthenticationData">3-D Secure Authentication Data<a class="hash-link" href="#3dSecureAuthenticationData" title="Direct link to heading">​</a></h2><p>The 3-D Secure system uses various data fields to report the authentication status of the Cardholder. Each 3-D Secure version may use slightly different terminology for the fields and have slightly different values but for ease of use the Gateway uses the terminology and values as described in this appendix.</p><p>The field’s values would normally be populated by the Gateway’s 3DS Server component (The 3DS Server is the Gateway/Merchant component that provides the interface with the 3DS Directory Server), however you may choose to use your own 3DS Server component and provide the values.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3d-secure-enrolment-status">3D Secure enrolment status<a class="hash-link" href="#3d-secure-enrolment-status" title="Direct link to heading">​</a></h3><p>The <code>threeDSEnrolled</code> field indicates if the card is enrolled in the 3-D Secure program.</p><p>The value is determined if the card number is within one of the enrolled ranges downloaded daily from the Directory Server using a Preparation Request/Response (PReq/PRes) message.</p><p>The field can contain one of the following values:</p><p><strong>Y – Enrolled</strong>. The card is enrolled in the 3-D Secure program and the payer is eligible for authentication
processing.</p><p><strong>N - Not Enrolled</strong>. The checked card is eligible for the 3-D Secure (it is within the card association’s range of accepted cards) but the card issuing bank does not participate in the 3-D Secure program. If the Cardholder later disputes the purchase, the issuer may not submit a chargeback to you.</p><p><strong>U - Unable To Verify Enrolment</strong>. The card associations were unable to verify whether the Cardholder is registered. As the card is ineligible for 3-D Secure, you can choose to accept the card nonetheless and precede the purchase as non-authenticated and submits authorisation with ECI 07.</p><p><strong>E - Error Verifying Enrolment</strong>. The Gateway encountered an error. This card is flagged as 3-D Secure ineligible. The card can be accepted for payment at your discretion.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-authentication-status">3DS Authentication status<a class="hash-link" href="#3ds-authentication-status" title="Direct link to heading">​</a></h3><p>The <code>threeDSAuthenticated</code> field indicates if the cardholder has been authenticated by the 3-D Secure program.</p><p>The value is provided by the Directory Server either on requesting authentication in the Authentication Response (ARes) message, in the case of a frictionless flow, or after a Cardholder
challenge in the Result Request (RReq) message, in the case of a challenge flow.</p><p>The field can contain one of the following values:</p><p><strong>Y - Authentication Successful</strong>. The Issuer has authenticated the Cardholder by verifying the identity information or password. A CAVV and an ECI of 5 is returned. The card is accepted for payment and authentication data passed to authorisation processing.</p><p><strong>A - Attempted Authentication</strong>. A proof of authentication attempt was generated. The Cardholder is not participating, but the attempt to authenticate was recorded. The card can be accepted for payment at your discretion and authentication data passed to authorisation processing.</p><p><strong>N - Not Authenticated</strong>. The Cardholder did not complete authentication and the card should not be accepted for payment.</p><p><strong>R – Rejected By Issuer</strong>. The Issuer rejected the transaction and must not be accepted for payment.</p><p><strong>D – Decoupled Challenge Required</strong>. Decoupled authentication confirmed.</p><p><strong>I – Information Only</strong>. 3DS Requestor challenge preference acknowledged.</p><p><strong>U - Unable To Authenticate</strong>. The authentication was not completed due to technical or another problem. A transmission error prevented authentication from completing. The card can be accepted for payment at your discretion, but no authentication data will be passed on to authorisation processing.</p><p><strong>E - Error Checking Authentication</strong>. The Gateway encountered an error. The card can be accepted for payment at your discretion, but no authentication data will be passed on to authorisation processing.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-transaction-identifier">3DS Transaction Identifier<a class="hash-link" href="#3ds-transaction-identifier" title="Direct link to heading">​</a></h3><p>The <code>threeDSXID</code> field provides a unique value to identify the transaction through the 3-D Secure system.
The value is provided by the Directory Server and is a 36-character universally unique identifier (UUID) as defined in IETF RFC 4122.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-electronic-commerce-indicator">3DS Electronic Commerce Indicator<a class="hash-link" href="#3ds-electronic-commerce-indicator" title="Direct link to heading">​</a></h3><p>The <code>threeDSECI</code> field indicates the security status of the transaction after the Cardholder has been authenticated or attempted authentication.</p><p>The value is provided by the Directory Server either on requesting authentication in the Authentication Response (ARes) message, in the case of a frictionless flow, or after a Cardholder challenge in the Result Request (RReq) message, in the case of a challenge flow.</p><p>The value is always present if the <code>threeDSAuthenticated</code> field has a value of Y (successful authentication), or A (attempted authentication) but can be present at other times.</p><p>The field can contain one of the following 2-digit values (the values are shown as pairs, the first value is for Visa and other Card Schemes and the second for Mastercard only):</p><ul><li><strong>05/02</strong> - Both cardholder and card issuing bank are 3DS enabled. 3DS card authentication is successful.</li><li><strong>06/01</strong> - Either cardholder or card issuing bank is not 3DS enrolled. 3DS card authentication is unsuccessful, in sample situations as:<ul><li>3DS cardholder not enrolled.</li><li>Card issuing bank is not 3DS ready.</li></ul></li><li><strong>07/00</strong> - Authentication is unsuccessful or not attempted. The card is either a non-3DS card or card issuing bank does not handle it as a 3DS transaction.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-cardholder-authentication-verification-value">3DS Cardholder Authentication Verification Value<a class="hash-link" href="#3ds-cardholder-authentication-verification-value" title="Direct link to heading">​</a></h3><p>The <code>threeDSCAVV</code> field provides proof that the Cardholder has been authenticated or attempted authentication.</p><p>The value is provided by the Directory Server either on requesting authentication in the Authentication Response (ARes) message, in the case of a frictionless flow, or after a Cardholder challenge in the Result Request (RReq) message, in the case of a challenge flow.</p><p>The value is present if the <code>threeDSAuthenticated</code> field has a value of Y (successful authentication), or A (attempted authentication).</p><p>The field will contain a 28-character Base-64 encoded value (32-characters for Mastercard).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3ds-enrolmentauthentication-only">3DS Enrolment/Authentication Only<a class="hash-link" href="#3ds-enrolmentauthentication-only" title="Direct link to heading">​</a></h3><p>Usually, the Gateway will perform most of the 3-D Secure processing in the background leaving the only the actual contacting of the issuers Access Control Server (ACS) to the Merchant.</p><p>However, there may be times when you may wish to gain more control over the Enrolment and Authentication process. The following field allows the request processing to stop after the 3-D Secure enrolment check or authentication check and return;</p><table><thead><tr><th>Name</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>threeDSOnly</td><td>No</td><td>Complete the processing as far as the next 3-D Secure stage and then return with the appropriate</td></tr><tr><td>response fields for that stage.</td><td></td><td></td></tr></tbody></table><p>As this stop is requested then a <code>responseCode</code> is returned as 0 (Success) however it will be recorded in the Merchant Management System (MMS) as 65792 (3DS IN PROGRESS) indicating that the transaction has been prematurely halted expecting it to be continued to the next 3-D Secure stage when required. In order to continue the process, the <code>threeDSRef</code> field is returned together with any relevant 3-D Secure response fields suitable for that stage in the processing.</p><p>If this flag is used when 3-D Secure is not enabled on the account or after the 3-D Secure process has been completed for the request (ie when the authentication step has completed), then passing the flag will cause the transaction to abort with a <code>responseCode</code> of 65795 (3DS PROCESSING NOT REQUIRED). This ensures that the transaction doesn’t go on to completion by accident while trying do 3-D Secure enrolment or authentication only.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hostedpaymentfields/transactiontypes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Transaction Types</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hostedpaymentfields/credentialsonfile"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Credentials on file &amp; Recurring Transactions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#psd2-sca-compliance" class="table-of-contents__link toc-highlight">PSD2 SCA Compliance</a><ul><li><a href="#obtaining-strong-customer-authentication" class="table-of-contents__link toc-highlight">Obtaining Strong Customer Authentication</a></li><li><a href="#sca-soft-declines" class="table-of-contents__link toc-highlight">SCA Soft-Declines</a></li><li><a href="#scaExemptions" class="table-of-contents__link toc-highlight">Exemptions to Strong Customer Authentication</a></li><li><a href="#scaUsing3dSecure" class="table-of-contents__link toc-highlight">SCA Using 3-D Secure</a></li></ul></li><li><a href="#3d-secure-overview" class="table-of-contents__link toc-highlight">3D Secure Overview</a></li><li><a href="#3ds-benefits" class="table-of-contents__link toc-highlight">3DS Benefits</a></li><li><a href="#3ds-limitations" class="table-of-contents__link toc-highlight">3DS Limitations</a></li><li><a href="#3ds-implementation" class="table-of-contents__link toc-highlight">3DS Implementation</a></li><li><a href="#request-flow" class="table-of-contents__link toc-highlight">Request Flow</a><ul><li><a href="#initial3dSecureRequest" class="table-of-contents__link toc-highlight">Initial Request (Verify Enrolment)</a></li><li><a href="#3dSecurecontinuationRequest" class="table-of-contents__link toc-highlight">Continuation Request (Check Authentication and Authorise)</a></li><li><a href="#multiple-challenges-and-frictionless-flow" class="table-of-contents__link toc-highlight">Multiple Challenges and Frictionless Flow</a></li><li><a href="#cardholder-challenge" class="table-of-contents__link toc-highlight">Cardholder Challenge</a></li><li><a href="#device-fingerprinting-challenge" class="table-of-contents__link toc-highlight">Device Fingerprinting Challenge</a></li><li><a href="#3dSecureChallengeResponse" class="table-of-contents__link toc-highlight">Challenge Response</a></li><li><a href="#final-response" class="table-of-contents__link toc-highlight">Final Response</a></li><li><a href="#externalAuthRequest" class="table-of-contents__link toc-highlight">External Authentication Request</a></li><li><a href="#external-authentication-response" class="table-of-contents__link toc-highlight">External Authentication Response</a></li><li><a href="#cardholder-information" class="table-of-contents__link toc-highlight">Cardholder Information</a></li><li><a href="#psd2-strong-customer-authentication" class="table-of-contents__link toc-highlight">PSD2 Strong Customer Authentication</a></li></ul></li><li><a href="#3dsOptions" class="table-of-contents__link toc-highlight">3DS Options</a></li><li><a href="#3dSecureAuthenticationData" class="table-of-contents__link toc-highlight">3-D Secure Authentication Data</a><ul><li><a href="#3d-secure-enrolment-status" class="table-of-contents__link toc-highlight">3D Secure enrolment status</a></li><li><a href="#3ds-authentication-status" class="table-of-contents__link toc-highlight">3DS Authentication status</a></li><li><a href="#3ds-transaction-identifier" class="table-of-contents__link toc-highlight">3DS Transaction Identifier</a></li><li><a href="#3ds-electronic-commerce-indicator" class="table-of-contents__link toc-highlight">3DS Electronic Commerce Indicator</a></li><li><a href="#3ds-cardholder-authentication-verification-value" class="table-of-contents__link toc-highlight">3DS Cardholder Authentication Verification Value</a></li><li><a href="#3ds-enrolmentauthentication-only" class="table-of-contents__link toc-highlight">3DS Enrolment/Authentication Only</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://developer.handpoint.com/cpdocs/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">In-Person Payments Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/cnpdocs/index.html">Online Payments Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Handpoint Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/handpointltd?lang=en" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Get our Apps</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://play.google.com/store/apps/details?id=com.handpoint.hipos&amp;hl=en&amp;gl=US&amp;pcampaignid=pcampaignidMKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get it on Google Play<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://apps.apple.com/us/app/handpoint/id1450546788?itsct=apps_box_link&amp;itscg=30200" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download on the App Store<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.handpoint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Handpoint Status Page<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://handpoint.atlassian.net/wiki/spaces/PD/overview?homepageId=5898250" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://handpoint.us6.list-manage.com/subscribe?u=4d9dff9e7edb7e57a67a7b252&amp;id=0a2179241e" target="_blank" rel="noopener noreferrer" class="footer__link-item">Subscribe to the Handpoint Newsletter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/handpoint" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.handpoint.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="https://handpoint.imgix.net/handpoint-logo-w.png?w=150" alt="Handpoint Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2023 Handpoint</div></div></div></footer></div>
<script src="/assets/js/runtime~main.69ab9cf3.js"></script>
<script src="/assets/js/main.f54a2a29.js"></script>
</body>
</html>