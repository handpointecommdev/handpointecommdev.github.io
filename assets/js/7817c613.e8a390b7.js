"use strict";(self.webpackChunkecommerce=self.webpackChunkecommerce||[]).push([[6882],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=u(n),m=r,h=p["".concat(s,".").concat(m)]||p[m]||c[m]||l;return n?a.createElement(h,o(o({ref:t},d),{},{components:n})):a.createElement(h,o({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,o[1]=i;for(var u=2;u<l;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},1399:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return o},default:function(){return c},frontMatter:function(){return l},metadata:function(){return i},toc:function(){return u}});var a=n(3117),r=(n(7294),n(3905));const l={sidebar_position:2},o="Sample Code & Examples",i={unversionedId:"samplecode",id:"samplecode",title:"Sample Code & Examples",description:"Transaction Types",source:"@site/batchintegration/samplecode.md",sourceDirName:".",slug:"/samplecode",permalink:"/batchintegration/samplecode",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/batchintegration/overview"},next:{title:"Transaction Types",permalink:"/batchintegration/transactiontypes"}},s={},u=[{value:"Transaction Types",id:"transaction-types",level:2},{value:"SALE",id:"sale",level:3},{value:"VERIFY",id:"verify",level:3},{value:"PREAUTH",id:"preauth",level:3},{value:"REFUND",id:"refund",level:3},{value:"Example HTTP Request",id:"example-http-request",level:2},{value:"Submission Request HTTP Headers",id:"submission-request-http-headers",level:3},{value:"Submission Response HTTP Headers",id:"submissionResponse",level:3},{value:"Status Request HTTP Headers",id:"status-request-http-headers",level:3},{value:"Status Response HTTP Headers",id:"status-response-http-headers",level:3},{value:"Submission Example",id:"submission-example",level:3},{value:"Testing",id:"testing",level:2},{value:"Test Amounts",id:"test-amounts",level:3},{value:"Test Cards",id:"testCards",level:3},{value:"Visa Credit",id:"visa-credit",level:4},{value:"Visa Debit",id:"visa-debit",level:4},{value:"Visa Electron",id:"visa-electron",level:4},{value:"Mastercard Credit",id:"mastercard-credit",level:4},{value:"Mastercard Debit",id:"mastercard-debit",level:4},{value:"UK Maestro",id:"uk-maestro",level:4},{value:"JCB",id:"jcb",level:4},{value:"American Express",id:"american-express",level:4},{value:"Diners Club",id:"diners-club",level:4},{value:"3D Secure Testing",id:"3d-secure-testing",level:3},{value:"Paypal Sandbox Accounts",id:"paypal-sandbox-accounts",level:3},{value:"Amazon Pay Sandbox Accounts",id:"amazon-pay-sandbox-accounts",level:3},{value:"Request Checking Only",id:"request-checking-only",level:3},{value:"Signature Calculation",id:"signatureCalculation",level:2},{value:"Example Signature Key",id:"example-signature-key",level:3},{value:"Example Transaction",id:"example-transaction",level:3},{value:"Step 1 - Sort transaction values by their field name",id:"step-1---sort-transaction-values-by-their-field-name",level:4},{value:"Step 2 - Create url encoded string from sorted fields",id:"step-2---create-url-encoded-string-from-sorted-fields",level:4},{value:"Step 3 - Normalise all line endings in the url encoded string",id:"step-3---normalise-all-line-endings-in-the-url-encoded-string",level:4},{value:"Step 4 - Append your signature key to the normalised string",id:"step-4---append-your-signature-key-to-the-normalised-string",level:4},{value:"Step 5 - Hash the string using the SHA-512 algorithm",id:"step-5---hash-the-string-using-the-sha-512-algorithm",level:4},{value:"Step 6 - Add the signature to the transaction form or post data",id:"step-6---add-the-signature-to-the-transaction-form-or-post-data",level:4},{value:"Sample Code PHP",id:"sample-code-php",level:3}],d={toc:u};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"sample-code--examples"},"Sample Code & Examples"),(0,r.kt)("h2",{id:"transaction-types"},"Transaction Types"),(0,r.kt)("h3",{id:"sale"},"SALE"),(0,r.kt)("p",null," The following example PHP code shows how to launch a batch of ",(0,r.kt)("strong",{parentName:"p"},"SALE")," transactions (3 in total):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"}," <?PHP \n\n // Merchant signature key\n $key = '3obzOxdqw6e1u';\n\n // Gateway URL\n $url = 'https://commerce-api.handpoint.com/batch/';\n\n // Create a unique multipart boundary\n $boundary = uniqid();\n\n // Requests\n $reqs = array(\n array(\n    'merchantID' => 155928,\n    'action' => 'SALE',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 1001,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 24,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'SALE',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 2002,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 24,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'SALE',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 3003,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 24,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n );\n\n // Create the batch parts\n $parts = array();\n foreach ($reqs as $req) {\n\n // Create the signature using the function called below.\n $req['signature'] = createSignature($req, $key);\n\n $parts[] =\n \"Content-Id: TX{$req['transactionUnique']}\\r\\n\" .\n \"Content-Type: application/x-www-form-urlencoded; charset=\\\"UTF-8\\\"\\r\\n\" .\n \"\\r\\n\" .\n http_build_query($req);\n }\n\n // Join the parts together separated by the boundary string\n $post = \"\\r\\n--{$boundary}\\r\\n\" . join(\"\\r\\n--{$boundary}\\r\\n\", $parts) . \"\\r\\n--{$boundary}--\\r\\n\";\n\n // Initiate and set curl options to post to the gateway\n $ch = curl_init($url);\n curl_setopt($ch, CURLOPT_POST, true);\n curl_setopt($ch, CURLOPT_POSTFIELDS, $post);\n curl_setopt($ch, CURLOPT_HEADER, true);\n curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\n curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n 'Content-type: multipart/mixed; charset=\"UTF-8\"; boundary=' . $boundary,\n 'Content-length: ' . strlen($post),\n));\n\n// Send the request\n$res = curl_exec($ch);\n\n// Normally would process the response here, but for this example just echo it out \n\nheader ('Content-Type: text/plain');\n\n$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);\n$header = substr($res, 0, $header_size);\n\n//Shows the Headers information\necho $header;\n\n\n// Close the connection to the gateway\ncurl_close($ch);\n\n// Function to create a message signature\n function createSignature(array $data, $key) {\n // Sort by field name\n ksort($data);\n\n // Create the URL encoded signature string\n $ret = http_build_query($data, '', '&');\n\n // Normalise all line endings (CRNL|NLCR|NL|CR) to just NL (%0A)\n $ret = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $ret);\n\n // Hash the signature string and the key together\n return hash('SHA512', $ret . $key);\n}\n?>\n")),(0,r.kt)("h3",{id:"verify"},"VERIFY"),(0,r.kt)("p",null,"The following example PHP code shows how to launch a batch of ",(0,r.kt)("strong",{parentName:"p"},"VERIFY")," transactions (3 in total):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"<?PHP \n\n // Merchant signature key --\x3e It will be provided by the Handpoint support team.\n $key = '3obzOxdqw6e1u';\n\n // Gateway URL\n $url = 'https://commerce-api.handpoint.com/batch/';\n\n // Create a unique multipart boundary\n $boundary = uniqid();\n\n // Requests\n $reqs = array(\n array(\n    'merchantID' => 155928,\n    'action' => 'VERIFY',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 0,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'VERIFY',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 0,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'VERIFY',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 0,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n );\n\n // Create the batch parts\n $parts = array();\n foreach ($reqs as $req) {\n\n // Create the signature using the function called below.\n $req['signature'] = createSignature($req, $key);\n\n $parts[] =\n \"Content-Id: TX{$req['transactionUnique']}\\r\\n\" .\n \"Content-Type: application/x-www-form-urlencoded; charset=\\\"UTF-8\\\"\\r\\n\" .\n \"\\r\\n\" .\n http_build_query($req);\n }\n\n // Join the parts together separated by the boundary string\n $post = \"\\r\\n--{$boundary}\\r\\n\" . join(\"\\r\\n--{$boundary}\\r\\n\", $parts) . \"\\r\\n--{$boundary}--\\r\\n\";\n\n // Initiate and set curl options to post to the gateway\n $ch = curl_init($url);\n curl_setopt($ch, CURLOPT_POST, true);\n curl_setopt($ch, CURLOPT_POSTFIELDS, $post);\n curl_setopt($ch, CURLOPT_HEADER, true);\n curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\n curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n 'Content-type: multipart/mixed; charset=\"UTF-8\"; boundary=' . $boundary,\n 'Content-length: ' . strlen($post),\n));\n\n// Send the request\n$res = curl_exec($ch);\n\n// Normally would process the response here, but for this example just echo it out \n\nheader ('Content-Type: text/plain');\n\n$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);\n$header = substr($res, 0, $header_size);\n\n//Shows the Headers information\necho $header;\n\n\n// Close the connection to the gateway\ncurl_close($ch);\n\n// Function to create a message signature\n function createSignature(array $data, $key) {\n // Sort by field name\n ksort($data);\n\n // Create the URL encoded signature string\n $ret = http_build_query($data, '', '&');\n\n // Normalise all line endings (CRNL|NLCR|NL|CR) to just NL (%0A)\n $ret = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $ret);\n\n // Hash the signature string and the key together\n return hash('SHA512', $ret . $key);\n}\n?>\n")),(0,r.kt)("h3",{id:"preauth"},"PREAUTH"),(0,r.kt)("p",null,"The following example PHP code shows how to launch a batch of ",(0,r.kt)("strong",{parentName:"p"},"PREAUTH")," transactions (3 in total):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"<?PHP \n\n // Merchant signature key --\x3e It will be provided by the Handpoint support team.\n $key = '3obzOxdqw6e1u';\n\n // Gateway URL\n $url = 'https://commerce-api.handpoint.com/batch/';\n\n // Create a unique multipart boundary\n $boundary = uniqid();\n\n // Requests\n $reqs = array(\n array(\n    'merchantID' => 155928,\n    'action' => 'PREAUTH',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 100,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'PREAUTH',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 101,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'PREAUTH',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 102,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    ),\n );\n\n // Create the batch parts\n $parts = array();\n foreach ($reqs as $req) {\n\n // Create the signature using the function called below.\n $req['signature'] = createSignature($req, $key);\n\n $parts[] =\n \"Content-Id: TX{$req['transactionUnique']}\\r\\n\" .\n \"Content-Type: application/x-www-form-urlencoded; charset=\\\"UTF-8\\\"\\r\\n\" .\n \"\\r\\n\" .\n http_build_query($req);\n }\n\n // Join the parts together separated by the boundary string\n $post = \"\\r\\n--{$boundary}\\r\\n\" . join(\"\\r\\n--{$boundary}\\r\\n\", $parts) . \"\\r\\n--{$boundary}--\\r\\n\";\n\n // Initiate and set curl options to post to the gateway\n $ch = curl_init($url);\n curl_setopt($ch, CURLOPT_POST, true);\n curl_setopt($ch, CURLOPT_POSTFIELDS, $post);\n curl_setopt($ch, CURLOPT_HEADER, true);\n curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\n curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n 'Content-type: multipart/mixed; charset=\"UTF-8\"; boundary=' . $boundary,\n 'Content-length: ' . strlen($post),\n));\n\n// Send the request\n$res = curl_exec($ch);\n\n// Normally would process the response here, but for this example just echo it out \n\nheader ('Content-Type: text/plain');\n\n$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);\n$header = substr($res, 0, $header_size);\n\n//Shows the Headers information\necho $header;\n\n\n// Close the connection to the gateway\ncurl_close($ch);\n\n// Function to create a message signature\n function createSignature(array $data, $key) {\n // Sort by field name\n ksort($data);\n\n // Create the URL encoded signature string\n $ret = http_build_query($data, '', '&');\n\n // Normalise all line endings (CRNL|NLCR|NL|CR) to just NL (%0A)\n $ret = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $ret);\n\n // Hash the signature string and the key together\n return hash('SHA512', $ret . $key);\n}\n?>\n")),(0,r.kt)("h3",{id:"refund"},"REFUND"),(0,r.kt)("p",null,"The following example PHP code shows how to launch a batch of ",(0,r.kt)("strong",{parentName:"p"},"REFUND")," transactions (3 in total):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"<?PHP \n\n // Merchant signature key \n $key = '3obzOxdqw6e1u';\n\n // Gateway URL\n $url = 'https://commerce-api.handpoint.com/batch/';\n\n // Create a unique multipart boundary\n $boundary = uniqid();\n\n // Requests\n $reqs = array(\n array(\n    'merchantID' => 155928,\n    'action' => 'REFUND',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 1001,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    'remoteAddress' => $_SERVER['REMOTE_ADDR'],\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'REFUND',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 1002,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    'remoteAddress' => $_SERVER['REMOTE_ADDR'],\n    ),\n array(\n    'merchantID' => 155928,\n    'action' => 'REFUND',\n    'type' => 1,\n    'currencyCode' => 826,\n    'countryCode' => 826,\n    'amount' => 1003,\n    'cardNumber' => '4012001037141112',\n    'cardExpiryMonth' => 12,\n    'cardExpiryYear' => 22,\n    'cardCVV' => '083',\n    'customerName' => 'Test Customer',\n    'customerEmail' => 'test@testcustomer.com',\n    'customerAddress' => '16 Test Street',\n    'customerPostCode' => 'TE15 5ST',\n    'orderRef' => 'Test purchase',\n    'transactionUnique' => uniqid(),\n    'threeDSRequired' => 'N',\n    'avscv2CheckRequired' => 'N',\n    'remoteAddress' => $_SERVER['REMOTE_ADDR'],\n    ),\n );\n\n // Create the batch parts\n $parts = array();\n foreach ($reqs as $req) {\n\n // Create the signature using the function called below.\n $req['signature'] = createSignature($req, $key);\n\n $parts[] =\n \"Content-Id: TX{$req['transactionUnique']}\\r\\n\" .\n \"Content-Type: application/x-www-form-urlencoded; charset=\\\"UTF-8\\\"\\r\\n\" .\n \"\\r\\n\" .\n http_build_query($req);\n }\n\n // Join the parts together separated by the boundary string\n $post = \"\\r\\n--{$boundary}\\r\\n\" . join(\"\\r\\n--{$boundary}\\r\\n\", $parts) . \"\\r\\n--{$boundary}--\\r\\n\";\n\n // Initiate and set curl options to post to the gateway\n $ch = curl_init($url);\n curl_setopt($ch, CURLOPT_POST, true);\n curl_setopt($ch, CURLOPT_POSTFIELDS, $post);\n curl_setopt($ch, CURLOPT_HEADER, true);\n curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);\n curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n curl_setopt($ch, CURLOPT_HTTPHEADER, array(\n 'Content-type: multipart/mixed; charset=\"UTF-8\"; boundary=' . $boundary,\n 'Content-length: ' . strlen($post),\n));\n\n// Send the request\n$res = curl_exec($ch);\n\n// Normally would process the response here, but for this example just echo it out \n\nheader ('Content-Type: text/plain');\n\n$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);\n$header = substr($res, 0, $header_size);\n\n//Shows the Headers information\necho $header;\n\n\n\n\n// Close the connection to the gateway\ncurl_close($ch);\n\n// Function to create a message signature\n function createSignature(array $data, $key) {\n // Sort by field name\n ksort($data);\n\n // Create the URL encoded signature string\n $ret = http_build_query($data, '', '&');\n\n // Normalise all line endings (CRNL|NLCR|NL|CR) to just NL (%0A)\n $ret = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $ret);\n\n // Hash the signature string and the key together\n return hash('SHA512', $ret . $key);\n}\n?>\n")),(0,r.kt)("h2",{id:"example-http-request"},"Example HTTP Request"),(0,r.kt)("h3",{id:"submission-request-http-headers"},"Submission Request HTTP Headers"),(0,r.kt)("p",null,"The following HTTP headers are sent for batch submission request:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"HTTP Header"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-type"),(0,r.kt)("td",{parentName:"tr",align:null},"Y"),(0,r.kt)("td",{parentName:"tr",align:null},"Content type of the batch request. This must be \u2018multipart/mixed\u2019 and contain a boundary parameter to separate each transaction request. A charset parameter is optional and any none UTF-8 request will be converted to UTF-8.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-encoding"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional content encoding applied to the request. The value should be a comma separated list of one or more: x-gzip, gzip, base64.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"authorization"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional username and password to authenticate the submitter.")))),(0,r.kt)("p",null,"The following HTTP headers are sent on each individual part request:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"HTTP Header"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-type"),(0,r.kt)("td",{parentName:"tr",align:null},"Y"),(0,r.kt)("td",{parentName:"tr",align:null},"Content type of the individual request. This must be \u2018application/xwww-form-urlencoded\u2019, A charset parameter is optional and any none UTF-8 request will be converted to UTF-8.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-encoding"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional content encoding applied to the request. The value should be a comma separated list of one or more: x-gzip, gzip, base64.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-id"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional identifier for each individual transaction with the batch. The Gateway will return this identifier in the submission response. If not sent, the Gateway will generate a unique identifier for each transaction.")))),(0,r.kt)("h3",{id:"submissionResponse"},"Submission Response HTTP Headers"),(0,r.kt)("p",null,"The following HTTP headers are received for batch submission response:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"HTTP Header"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"status"),(0,r.kt)("td",{parentName:"tr",align:null},"HTTP status header. Possible value are:",(0,r.kt)("br",null),"200 \u2013 Batch submission status response ok",(0,r.kt)("br",null),"201 \u2013 Batch submission received and stored",(0,r.kt)("br",null),"400 \u2013 Batch submission invalid",(0,r.kt)("br",null),"401 \u2013 Unauthorised (none or incorrect credentials)",(0,r.kt)("br",null),"405 \u2013 HTTP method was not POST/PUT or GET",(0,r.kt)("br",null),"500 \u2013 Internal Gateway error")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location"),(0,r.kt)("td",{parentName:"tr",align:null},"URL to use to monitor the status of the batch. A unique batch reference number will be provided in the URL in the format: XXXX-XXXX-XXXX-XXXX (eg 1A23-B4C5-DEF6-G7HI). This reference number is used to request information about the status of a batch via HTTP GET requests to the URL endpoint")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"x-p3-token"),(0,r.kt)("td",{parentName:"tr",align:null},"If user authentication was sent in the initial request, this header will contain a token that can be used for future requests for the status of the batch instead of having to use a username/password.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-type"),(0,r.kt)("td",{parentName:"tr",align:null},"Content type of the HTTP batch request. This will be \u2018multipart/mixed\u2019 and contain a boundary parameter to separate each transaction request.")))),(0,r.kt)("p",null,"The following HTTP headers are received on each individual part response:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"HTTP Header"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-type"),(0,r.kt)("td",{parentName:"tr",align:null},"Content type of the individual request. This will be \u2018application/x-www-formurlencoded\u2019, A charset parameter is optional and any none UTF-8 request will be converted to UTF-8.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"content-id"),(0,r.kt)("td",{parentName:"tr",align:null},"The content ID sent in the initial request. If no content-id header was sent, the Gateway will return a unique content ID per transaction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"x-transaction-id"),(0,r.kt)("td",{parentName:"tr",align:null},"The Gateway transaction ID. This will be empty if the transaction is currently pending in this stage.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"x-transaction-response"),(0,r.kt)("td",{parentName:"tr",align:null},"A message containing the current status of the transaction.Possible value are:",(0,r.kt)("br",null),"skipped \u2013 insufficient permissions to view transaction",(0,r.kt)("br",null),"pending \u2013 queued for processing",(0,r.kt)("br",null),"success \u2013 (Response Message)",(0,r.kt)("br",null),"failure \u2013 (Response Message)")))),(0,r.kt)("h3",{id:"status-request-http-headers"},"Status Request HTTP Headers"),(0,r.kt)("p",null,"The following HTTP headers are used during a batch status request:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"HTTP Header"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"authorization"),(0,r.kt)("td",{parentName:"tr",align:null},"Y"),(0,r.kt)("td",{parentName:"tr",align:null},"Mandatory username and password to authenticate the submitter")))),(0,r.kt)("h3",{id:"status-response-http-headers"},"Status Response HTTP Headers"),(0,r.kt)("p",null,"The batch status response is identical to the ",(0,r.kt)("a",{parentName:"p",href:"#submissionResponse"},"submission status response"),"."),(0,r.kt)("h3",{id:"submission-example"},"Submission Example"),(0,r.kt)("p",null,"The following shows an example of a batch submission request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http"}," PUT /batch/?validate=0 HTTP/1.1\n Authorization: Basic bmljay50dXJuZXI6dGVzdGluZzI=\n Host: gateway.example.com\n Accept: */*\n Content-type: multipart/mixed; charset=UTF-8; boundary=5de63a42507a9\n Content-length: 1404\n\n --5de63a42507a9\n Content-Id: TX5de63a42507ac\n Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n\nmerchantID=100001&action=SALE&type=1&currencyCode=826&countryCode=826&amount=680&transactionUnique=5de63a42507a\nc&orderRef=Test+Transaction&cardNumber=4929+4212+3460+0821&cardExpiryDate=1219&duplicateDelay=0&signature=3cd68\n6fdd40449ef33534baa62732c95fc127ff591fae3b5b611ccb38573ad921d199396e27cffd14faa4f46df8dde310252920fd1b33607b029\nb9b6ff669e2b\n\n --5de63a42507a9\n Content-Id: TX5de63a42af062\n Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n\nmerchantID=100001&action=SALE&type=1&currencyCode=826&countryCode=826&amount=681&transactionUnique=5de63a42af06\n2&orderRef=Test+Transaction&cardNumber=4929+4212+3460+0821&cardExpiryDate=1219&duplicateDelay=0&signature=55f41\n1d40954be7f7089e84fe489438f09fc1b37c0964e46b0fab8bdcb44e13ed3ea11b9deb9da89a6d7b45133709a126bd3581f6329bf888b83\n231184597231\n\n --5de63a42507a9\n Content-Id: TX5de63a42ca9cd\n Content-Type: application/x-www-form-urlencoded; charset=UTF-8\n\nmerchantID=100001&action=SALE&type=1&currencyCode=826&countryCode=826&amount=682&transactionUnique=5de63a42ca9c\nd&orderRef=Test+Transaction&cardNumber=4929+4212+3460+0821&cardExpiryDate=1219&duplicateDelay=0&signature=c2962\n66cb9bc8082957c700da9651d98add176dd8bd62eb3b7098566c7d8e23a3426b776de815e99149c6681978b1addedac762339563732d8a4\n49b6cca3a3c2\n\n --5de63a42507a9-- \n")),(0,r.kt)("p",null,"The following shows an example of a batch submission response:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http"},"HTTP/1.1 201 Created\nDate: Tue, 01 Jan 2019 09:30:45 GMT\nServer: Apache/2.4.23 (Win64) OpenSSL/1.0.2k-fips PHP/5.4.12\nX-Powered-By: PHP/5.4.12\nx-p3-token: YTo1OntzOjc6InZlcnNpb24iO3M6ODoiUDNUSy8yLjAiO3M6NzoicHVycG9zZSI7czo0OiJhdXRoIjtzOjc6ImNyZWF0b3IiO3M\n6NToiQkFUQ0giO3M6NzoiY3JlYXRlZCI7aToxNTc1MzY5Mjg1O3M6NzoiZXhwaXJlcyI7aToxNTc1MzcyODg1O30.czozOiI2MjkiOw.zdfxxXY\ntC2Wc4yyk-lEos-wZ99pEJtPGYpXR4KCiWW_56nmOysarOaMucrWPIt-NzwFzgq3-7u4Ud6uYkQcWBQ\nLocation: /batch/2D6D-AC2C-BF55-2A8C\nContent-disposition: attachment; filename=\"batch-2D6D-AC2C-BF55-2A8C\"\nContent-Length: 1857\nContent-Type: multipart/mixed; charset=UTF-8; boundary=5de63a5c1a071\n\nTransaction 'TX5de63a42507ac' - pending - queued for processing\nTransaction 'TX5de63a42af062' - pending - queued for processing\nTransaction 'TX5de63a42ca9cd' - pending - queued for processing\n\n--5de63a5c1a071\nContent-Id: TX5de63a42507ac\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Transaction-ID:\nX-Transaction-Response: pending - queued for processing\n\nmerchantID=100001&action=SALE&type=1\xa4cyCode=826&countryCode=826&amount=680&transactionUnique=5de63a42507ac&orde\nrRef=Test+Transaction&cardNumber=492942%2A%2A%2A%2A%2A%2A0821&cardExpiryDate=1219&duplicateDelay=0&signature=03\n84bbf6ca0fc153e1e27a0cfc51f3b1cd1c2cff7a49aa4e9439bba38262183e9ac7d156f218eba1ef8d04f9e6a7fa6fbc9c2b3ab990c70e0\n6dc7c6923e5b27b\n\n--5de63a5c1a071\nContent-Id: TX5de63a42af062\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Transaction-ID:\nX-Transaction-Response: pending - queued for processing\n\nmerchantID=100001&action=SALE&type=1\xa4cyCode=826&countryCode=826&amount=681&transactionUnique=5de63a42af062&orde\nrRef=Test+Transaction&cardNumber=492942%2A%2A%2A%2A%2A%2A0821&cardExpiryDate=1219&duplicateDelay=0&signature=1e\n13e23c2b90a30f4403d604ac20302b5504b886b0b5c9ace0764fc8d966d120f5a1beca975805292780c22953b4e6ca71f67f499804f19d2\n718518463a598c4\n\n--5de63a5c1a071\nContent-Id: TX5de63a42ca9cd\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Transaction-ID:\nX-Transaction-Response: pending - queued for processing\n\nmerchantID=100001&action=SALE&type=1\xa4cyCode=826&countryCode=826&amount=682&transactionUnique=5de63a42ca9cd&orde\nrRef=Test+Transaction&cardNumber=492942%2A%2A%2A%2A%2A%2A0821&cardExpiryDate=1219&duplicateDelay=0&signature=c4\n56aa211f8e3e568a40051bfd38406be02566fcd72d3bb1547f4d43e75db1d069eaa4158aa035337cac084633df945a13471db6b1a3fcd6c\n0749626d9bc0044\n\n--5de63a5c1a071-- \n")),(0,r.kt)("h2",{id:"testing"},"Testing"),(0,r.kt)("p",null,"You will be provided with unique test Merchant Account IDs during the onboarding process. Refer to the ",(0,r.kt)("a",{parentName:"p",href:"overview#authentication"},"authentication")," section for the list of required parameters. Test Merchant Accounts are connected to a Simulator and not to an actual Acquirer. The Simulator will emulate the function of an Acquirer and provide simulated responses and authorisation codes."),(0,r.kt)("h3",{id:"test-amounts"},"Test Amounts"),(0,r.kt)("p",null,"When testing the transaction amount can be used to trigger different authorisation and settlement outcomes as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Min. Amount"),(0,r.kt)("th",{parentName:"tr",align:null},"Max. Amount"),(0,r.kt)("th",{parentName:"tr",align:null},"Authorisation response"),(0,r.kt)("th",{parentName:"tr",align:null},"Settlement outcome"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"100 (1.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"2499 (24.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(0) AUTH CODE: XXXXXX"),(0,r.kt)("td",{parentName:"tr",align:null},"ACCEPTED")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2500 (25.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"4999 (49.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(0) AUTH CODE: XXXXXX"),(0,r.kt)("td",{parentName:"tr",align:null},"REJECTED")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5000 (50.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"7499 (74.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(1) CARD REFERRED ",(0,r.kt)("br",null)," (0) AUTH CODE: XXXXXX"),(0,r.kt)("td",{parentName:"tr",align:null},"ACCEPTED")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"7500 (75.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"9999 (99.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(1) CARD REFERRED ",(0,r.kt)("br",null)," (0) AUTH CODE: XXXXXX"),(0,r.kt)("td",{parentName:"tr",align:null},"REJECTED")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"10000 (100.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"14999 (49.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(5) CARD DECLINED"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"15000 (150.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"19999 (199.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(4) CARD DECLINED \u2013 KEEP CARD"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"20000 (200.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"24999 (249.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(65) CARD DECLINED - SCA REQUIRED ",(0,r.kt)("br",null)," (0) AUTH CODE: XXXXXX"),(0,r.kt)("td",{parentName:"tr",align:null},"ACCEPTED")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"25000 (250.00)"),(0,r.kt)("td",{parentName:"tr",align:null},"29999 (299.99)"),(0,r.kt)("td",{parentName:"tr",align:null},"(65) CARD DECLINED \u2013 SCA REQUIRED ",(0,r.kt)("br",null),"  (5) CARD DECLINED"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A")))),(0,r.kt)("p",null,"Any other amount will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 66311 (Invalid Test Amount)."),(0,r.kt)("p",null,"The settlement outcome only applies to transactions which reach settlement due to being successfully authorised and captured and not cancelled. The amount captured is used when determining the settlement outcome rather than the amount authorised."),(0,r.kt)("p",null,"The range 5000 to 9999 can be used to test manual authorisations. If the transaction does not contain an ",(0,r.kt)("inlineCode",{parentName:"p"},"authorisationCode")," request field, then the Simulator will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 1 (CARD REFERRED). If it does, then it will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 0 (SUCCESS), with an amount between 50000 and 7499 being accepted at settlement and an amount of 7500 to 9999 being rejected."),(0,r.kt)("p",null,"The range 20000 to 29999 can be used to test secure customer authentication (SCA) soft declines. If the transaction is eligible to request SCA then the Simulator will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 65 (SCA REQUIRED). If not, then it will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 0 (SUCCESS) for the range 20000 to 24999 or 5 (DO NOT HONOR) for the range 25000 to 29999. Successful transactions will be approved at settlement."),(0,r.kt)("p",null,"Note: SCA exemptions are not supported by the simulator and so cannot be used to request that SCA is not required."),(0,r.kt)("h3",{id:"testCards"},"Test Cards"),(0,r.kt)("p",null,"The test accounts will only accept card numbers that are designated for test purposes. These test cards cannot be used on production accounts."),(0,r.kt)("p",null,"To test AVS and CV2 verification then the associated CVV and billing addresses are provided for each card. If a different value is used, then the Simulator will mark the responses as \u2018not matched\u2019."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Unless stated otherwise an expiry date sometime in the near future should be used.")),(0,r.kt)("h4",{id:"visa-credit"},"Visa Credit"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4929421234600821"),(0,r.kt)("td",{parentName:"tr",align:null},"356"),(0,r.kt)("td",{parentName:"tr",align:null},"Flat 6 Primrose Rise",(0,r.kt)("br",null)," 347 Lavender Road ",(0,r.kt)("br",null),"Northampton ",(0,r.kt)("br",null)," NN17 8YG")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4543059999999982"),(0,r.kt)("td",{parentName:"tr",align:null},"110"),(0,r.kt)("td",{parentName:"tr",align:null},"76 Roseby Avenue",(0,r.kt)("br",null)," Manchester ",(0,r.kt)("br",null),"M63X 7TH")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4543059999999990"),(0,r.kt)("td",{parentName:"tr",align:null},"689"),(0,r.kt)("td",{parentName:"tr",align:null},"23 Rogerham Mansions",(0,r.kt)("br",null),"4578 Ermine Street",(0,r.kt)("br",null)," Borehamwood ",(0,r.kt)("br",null)," WD54 8TH")))),(0,r.kt)("h4",{id:"visa-debit"},"Visa Debit"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4539791001730106"),(0,r.kt)("td",{parentName:"tr",align:null},"289"),(0,r.kt)("td",{parentName:"tr",align:null},"Unit 5 Pickwick Walk",(0,r.kt)("br",null),"120 Uxbridge Road Hatch End",(0,r.kt)("br",null),"Middlesex",(0,r.kt)("br",null),"HA6 7HJ")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4462000000000003"),(0,r.kt)("td",{parentName:"tr",align:null},"672"),(0,r.kt)("td",{parentName:"tr",align:null},"Mews 57",(0,r.kt)("br",null),"Ladybird Drive",(0,r.kt)("br",null),"Denmark",(0,r.kt)("br",null)," 65890")))),(0,r.kt)("h4",{id:"visa-electron"},"Visa Electron"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"4917480000000008"),(0,r.kt)("td",{parentName:"tr",align:null},"009"),(0,r.kt)("td",{parentName:"tr",align:null},"5-6 Ross Avenue",(0,r.kt)("br",null),"Birmingham",(0,r.kt)("br",null),"B67 8UJ")))),(0,r.kt)("h4",{id:"mastercard-credit"},"Mastercard Credit"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5301250070000191"),(0,r.kt)("td",{parentName:"tr",align:null},"419"),(0,r.kt)("td",{parentName:"tr",align:null},"25 The Larches Narborough",(0,r.kt)("br",null),"Leicester",(0,r.kt)("br",null),"LE10 2RT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5413339000001000"),(0,r.kt)("td",{parentName:"tr",align:null},"304"),(0,r.kt)("td",{parentName:"tr",align:null},"Pear Tree Cottage",(0,r.kt)("br",null),"The Green",(0,r.kt)("br",null),"Milton Keynes",(0,r.kt)("br",null),"MK11 7UY")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5434849999999951"),(0,r.kt)("td",{parentName:"tr",align:null},"470"),(0,r.kt)("td",{parentName:"tr",align:null},"34a Rubbery Close",(0,r.kt)("br",null),"Cloisters Run",(0,r.kt)("br",null),"Rugby",(0,r.kt)("br",null),"CV21 8JT")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5434849999999993"),(0,r.kt)("td",{parentName:"tr",align:null},"557"),(0,r.kt)("td",{parentName:"tr",align:null},"4-7 The Hay Market",(0,r.kt)("br",null),"Grantham",(0,r.kt)("br",null),"NG32 4HG")))),(0,r.kt)("h4",{id:"mastercard-debit"},"Mastercard Debit"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"5573 4712 3456 7898"),(0,r.kt)("td",{parentName:"tr",align:null},"159"),(0,r.kt)("td",{parentName:"tr",align:null},"Merevale Avenue",(0,r.kt)("br",null),"Leicester",(0,r.kt)("br",null),"LE10 2BU")))),(0,r.kt)("h4",{id:"uk-maestro"},"UK Maestro"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"6759 0150 5012 3445 002"),(0,r.kt)("td",{parentName:"tr",align:null},"309"),(0,r.kt)("td",{parentName:"tr",align:null},"The Parkway",(0,r.kt)("br",null),"5258 Larches Approach Hull",(0,r.kt)("br",null),"North Humberside",(0,r.kt)("br",null),"HU10 5OP")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"6759 0168 0000 0120 097"),(0,r.kt)("td",{parentName:"tr",align:null},"701"),(0,r.kt)("td",{parentName:"tr",align:null},"The Manor",(0,r.kt)("br",null),"Wolvey Road",(0,r.kt)("br",null),"Middlesex",(0,r.kt)("br",null),"TW7 9FF")))),(0,r.kt)("h4",{id:"jcb"},"JCB"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"3540599999991047"),(0,r.kt)("td",{parentName:"tr",align:null},"209"),(0,r.kt)("td",{parentName:"tr",align:null},"2 Middle Wallop Merideth-in-the-Wolds",(0,r.kt)("br",null),"Lincolnshire",(0,r.kt)("br",null),"LN2 8HG")))),(0,r.kt)("h4",{id:"american-express"},"American Express"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"374245455400001"),(0,r.kt)("td",{parentName:"tr",align:null},"4887"),(0,r.kt)("td",{parentName:"tr",align:null},"The Hunts Way",(0,r.kt)("br",null),"Southampton",(0,r.kt)("br",null),"SO18 1GW")))),(0,r.kt)("h4",{id:"diners-club"},"Diners Club"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Number"),(0,r.kt)("th",{parentName:"tr",align:null},"CVV"),(0,r.kt)("th",{parentName:"tr",align:null},"Address"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"36432685260294"),(0,r.kt)("td",{parentName:"tr",align:null},"111"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A")))),(0,r.kt)("p",null,"Diners Club do not support the Address Verification Service (AVS). For testing purposes, we advise that a separate Merchant Account is used with AVS is turned off."),(0,r.kt)("h3",{id:"3d-secure-testing"},"3D Secure Testing"),(0,r.kt)("p",null,"Your test accounts are connected to our 3-D Secure Product Integration Testing (PIT) system rather than to the production 3-D Secure servers. You can use any of the test cards provided above with this PIT system, and the authentication status returned by the Directory Server (for frictionless flow simulation) can be selected using the value of the card expiry month as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Card Expiry Month"),(0,r.kt)("th",{parentName:"tr",align:null},"Auth Status"),(0,r.kt)("th",{parentName:"tr",align:null},"Simulation (Frictionless)"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"01 - January"),(0,r.kt)("td",{parentName:"tr",align:null},"Y"),(0,r.kt)("td",{parentName:"tr",align:null},"Fully authenticated")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"02 - February"),(0,r.kt)("td",{parentName:"tr",align:null},"N"),(0,r.kt)("td",{parentName:"tr",align:null},"Not authenticated")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"03 - March"),(0,r.kt)("td",{parentName:"tr",align:null},"U"),(0,r.kt)("td",{parentName:"tr",align:null},"Unknown authentication status")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"04 - April"),(0,r.kt)("td",{parentName:"tr",align:null},"A"),(0,r.kt)("td",{parentName:"tr",align:null},"Attempted authentication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"05 - May"),(0,r.kt)("td",{parentName:"tr",align:null},"D"),(0,r.kt)("td",{parentName:"tr",align:null},"Decoupled authentication")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"06 - June"),(0,r.kt)("td",{parentName:"tr",align:null},"R"),(0,r.kt)("td",{parentName:"tr",align:null},"Transaction rejected (do not attempt to send for authorisation)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"07 \u2013 July"),(0,r.kt)("td",{parentName:"tr",align:null},"E"),(0,r.kt)("td",{parentName:"tr",align:null},"Unknown error performing 3-D Secure checks")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"08 - August"),(0,r.kt)("td",{parentName:"tr",align:null},"E"),(0,r.kt)("td",{parentName:"tr",align:null},"Error due to timeout communicating with the Directory Server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"09 \u2013 September"),(0,r.kt)("td",{parentName:"tr",align:null},"E"),(0,r.kt)("td",{parentName:"tr",align:null},"Error due to corrupt response from the Directory Server.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"10 \u2013 October"),(0,r.kt)("td",{parentName:"tr",align:null},"I"),(0,r.kt)("td",{parentName:"tr",align:null},"Information only")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"11 \u2013 November"),(0,r.kt)("td",{parentName:"tr",align:null},"U"),(0,r.kt)("td",{parentName:"tr",align:null},"Unknown authentication due to Cardholder not enrolled (error 13)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"12 - December"),(0,r.kt)("td",{parentName:"tr",align:null},"C"),(0,r.kt)("td",{parentName:"tr",align:null},"Frictionless not possible, challenge Cardholder")))),(0,r.kt)("p",null,"An expiry month of 12 will simulate the non frictionless flow and desired authentication status (threeDSAuthenticated) can be selected on the challenge dialog shown by the PIT Access Control Server."),(0,r.kt)("p",null,"When using an expiry month from the above table please use a suitable expiry year to ensure the date is sometime in the near future."),(0,r.kt)("h3",{id:"paypal-sandbox-accounts"},"Paypal Sandbox Accounts"),(0,r.kt)("p",null,"Please contact customer support to have your own PayPal test Merchant account created that connects to your own PayPal sandbox account, thus enabling you to view the transactions as they are sent to PayPal."),(0,r.kt)("h3",{id:"amazon-pay-sandbox-accounts"},"Amazon Pay Sandbox Accounts"),(0,r.kt)("p",null,"Please contact customer support to have your own Amazon Pay test Merchant account created that connects to your own Amazon Pay sandbox account, thus enabling you to view the transactions as they are sent to Amazon Pay."),(0,r.kt)("h3",{id:"request-checking-only"},"Request Checking Only"),(0,r.kt)("p",null,"Sometimes, you may wish to submit a request to the Gateway in order for it to be \u2018validated only\u2019 and not processed by the simulator or sent to the Acquirer. In these cases, the following flag can be used that will stop the processing after the integrity verification has been performed:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"checkOnly"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Check the request for syntax and field value errors only. Do not attempt to submit the transaction for honouring by the Merchant\u2019s financial institution.")))),(0,r.kt)("p",null,"If the request is OK, then a responseCode is returned as 0 (Success); otherwise, the code that would have prevented the request from completing is returned."),(0,r.kt)("p",null,"Note: in these cases, the request is not stored by the Gateway and is not available within the Merchant Management System (MMS)."),(0,r.kt)("h2",{id:"signatureCalculation"},"Signature Calculation"),(0,r.kt)("p",null,"It is highly recommended that transactions are protected using message signing. The signing process offers a quick and simple way to ensure that the message came from an authorised source and has not been tampered with during transmission."),(0,r.kt)("p",null,"Signing, however, must be completed on your servers and never left for the Customer\u2019s browser to complete in JavaScript, as this would mean revealing your secret signature code to anyone who viewed the JavaScript code in the browser."),(0,r.kt)("p",null,"Signatures are especially important when a transaction is sent from a browser\u2019s payment form via the use of hidden form fields because the Customer can easily use tools built into their browser to modify these hidden fields and change items such as the amount they should be charged."),(0,r.kt)("p",null,"Care must be taken to ensure that fields are sorted before signing into ascending field name order according to their numeric ASCII value. Some languages natural sort routines do NOT use ASCII order by default and so need to be adjusted or alternative methods used."),(0,r.kt)("p",null,"Also, when signing requests with fields formatted as per the ",(0,r.kt)("a",{parentName:"p",href:"overview#fieldFormats"},"format guide"),", only the root integration field is included in any sorting as the sub-fields are part of the value and should not have their order changed. The sub-fields must then be sent in the same order as they were hashed if added as hidden fields in HTML forms etc.\nThe section below gives a step-by-step example of how to sign a transaction, complete with coding examples using the PHP language."),(0,r.kt)("h3",{id:"example-signature-key"},"Example Signature Key"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$key = 'DontTellAnyone'\n")),(0,r.kt)("h3",{id:"example-transaction"},"Example Transaction"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$tran = array ( \n    'merchantID' => '100001',  //merchantID will be provided by the Handpoint support team\n    'action' => 'SALE', //action could be SALE, VERIFY or PREAUTH \n    'type' => '1', //1 \u2013> E-commerce (ECOM), 2 \u2013> Mail Order/Telephone Order (MOTO), 9 \u2013> Continuous Authority (CA)\n    'currencyCode' => '826', //ISO 3-letter currency code. 826 -> GBP\n    'countryCode' => '826', //ISO 3-letter country code. 826 -> United Kingdom\n    'amount' => '2691', //Either major currency units includes a single decimal point such as \u201910.99'. \n                      //Minor currency units contains no decimal points such as \u20181099\n    'transactionUnique' => '55f025addd3c2', //Unique identifier for this transaction. This is an added security feature to combat transaction spoofing\n    'orderRef' => 'Signature Test',  //Free format text field to store order details, reference numbers, etc. for the Merchant\u2019s records.\n    'cardNumber' => '4929 4212 3460 0821', //Card Number\n    'cardExpiryDate' => '1213', ) //Card expiry date\n")),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"The transaction used for signature calculation must not include any 'signature' field as this will be added after signing when its value is known.")),(0,r.kt)("h4",{id:"step-1---sort-transaction-values-by-their-field-name"},"Step 1 - Sort transaction values by their field name"),(0,r.kt)("p",null,"Transaction fields must be in ascending field name order according to their numeric ASCII value."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"ksort($tran);\narray ( 'action' => 'SALE', 'amount' => '2691', 'cardExpiryDate' => '1213', 'cardNumber' => '4929 4212 3460 0821', 'countryCode' => '826', 'currencyCode' => '826', 'merchantID' => '100001', 'orderRef' => 'Signature Test', 'transactionUnique' => '55f025addd3c2', 'type' => '1' )\n")),(0,r.kt)("h4",{id:"step-2---create-url-encoded-string-from-sorted-fields"},"Step 2 - Create url encoded string from sorted fields"),(0,r.kt)("p",null,"Use RFC 1738 and the application/x-www-form-urlencoded media type, which implies that spaces are encoded as plus (+) signs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$str = http_build_query($tran, '', '&');\n\naction=SALE&amount=2691&cardExpiryDate=1213&cardNumber=4929+4212+3460+0821&countryCode=826&currencyCode=826&merchantID=100001&orderRef=Signature+Test&transactionUnique=55f025addd3c2&type=1\n")),(0,r.kt)("h4",{id:"step-3---normalise-all-line-endings-in-the-url-encoded-string"},"Step 3 - Normalise all line endings in the url encoded string"),(0,r.kt)("p",null,"Convert all CR NL, NL CR, CR character sequences to a single NL character."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$str = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $str);\n\naction=SALE&amount=2691&cardExpiryDate=1213&cardNumber=4929+4212+3460+0821&countryCode=826&currencyCode=826&merchantID=100001&orderRef=Signature+Test&transactionUnique=55f025addd3c2&type=1\n")),(0,r.kt)("h4",{id:"step-4---append-your-signature-key-to-the-normalised-string"},"Step 4 - Append your signature key to the normalised string"),(0,r.kt)("p",null,"The signature key is appended to the normalised string with no separator characters."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$str .= 'DontTellAnyone'\n\naction=SALE&amount=2691&cardExpiryDate=1213&cardNumber=4929+4212+3460+0821&countryCode=826&currencyCode=826&merchantID=100001&orderRef=Signature+Test&transactionUnique=55f025addd3c2&type=1DontTellAnyone\n")),(0,r.kt)("h4",{id:"step-5---hash-the-string-using-the-sha-512-algorithm"},"Step 5 - Hash the string using the SHA-512 algorithm"),(0,r.kt)("p",null,"The normalised string is hashed to a more compact value using the secure SHA-512 hashing algorithm."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"$signature = hash('SHA512', $str);\n\nda0acd2c404945365d0e7ae74ad32d57c561e9b942f6bdb7e3dda49a08fcddf74fe6af6b23b8481b8dc8895c12fc21c72c69d60f137fdf574720363e33d94097\n")),(0,r.kt)("h4",{id:"step-6---add-the-signature-to-the-transaction-form-or-post-data"},"Step 6 - Add the signature to the transaction form or post data"),(0,r.kt)("p",null,"The signature should be sent as part of the transaction in a field called 'signature'."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},'<input type="hidden" name="signature" value="<?=$signature?>">\nor\n$tran[\'signature\'] = $signature;\n')),(0,r.kt)("h3",{id:"sample-code-php"},"Sample Code PHP"),(0,r.kt)("p",null,"Example of calculating the signature in PHP:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"\n<?PHP \n\n//Merchant signature key\n$key = '3obzOxdqw6e1u';\n\n\n//Request Information\n$tran = array (\n'merchantID' => '100001',  //merchantID will be provided by the Handpoint support team\n    'action' => 'SALE', //action could be SALE, VERIFY or PREAUTH \n    'type' => '1', //1 \u2013> E-commerce (ECOM), 2 \u2013> Mail Order/Telephone Order (MOTO), 9 \u2013> Continuous Authority (CA)\n    'currencyCode' => '826', //ISO 3-letter currency code. 826 -> GBP\n    'countryCode' => '826', //ISO 3-letter country code. 826 -> United Kingdom\n    'amount' => '2691', //Either major currency units includes a single decimal point such as \u201910.99'. \n                      //Minor currency units contains no decimal points such as \u20181099\n    'transactionUnique' => '55f025addd3c2', //Unique identifier for this transaction. This is an added security feature to combat transaction spoofing\n    'orderRef' => 'Signature Test',  //Free format text field to store order details, reference numbers, etc. for the Merchant\u2019s records.\n    'cardNumber' => '4929 4212 3460 0821', //Card Number\n    'cardExpiryDate' => '1213',\n);\n \n\n ksort($tran);\n\n $str = http_build_query($tran, '', '&');\n\n $str = str_replace(array('%0D%0A', '%0A%0D', '%0D'), '%0A', $str);\n\n $str .= '3obzOxdqw6e1u';\n\n $signature = hash('SHA512', $str);\n\n //Prints the signature\n printf(\"Signature %s\", $signature);\n ?>\n\n")))}c.isMDXComponent=!0}}]);