"use strict";(self.webpackChunkecommerce=self.webpackChunkecommerce||[]).push([[3913],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return c}});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),m=d(a),c=r,h=m["".concat(s,".").concat(c)]||m[c]||p[c]||i;return a?n.createElement(h,l(l({ref:t},u),{},{components:a})):n.createElement(h,l({ref:t},u))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var d=2;d<i;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},3e3:function(e,t,a){a.r(t),a.d(t,{assets:function(){return s},contentTitle:function(){return l},default:function(){return p},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return d}});var n=a(3117),r=(a(7294),a(3905));const i={sidebar_position:5},l="Credentials on file & Recurring Transactions",o={unversionedId:"credentialsonfile",id:"credentialsonfile",title:"Credentials on file & Recurring Transactions",description:"Credentials on File",source:"@site/batchintegration/credentialsonfile.md",sourceDirName:".",slug:"/credentialsonfile",permalink:"/batchintegration/credentialsonfile",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Transaction Types",permalink:"/batchintegration/transactiontypes"},next:{title:"Advanced Gateway Functionalities",permalink:"/batchintegration/advancedfunctionalities"}},s={},d=[{value:"Credentials on File",id:"credentials-on-file",level:2},{value:"Consumer Initiated Transactions (CIT)",id:"consumer-initiated-transactions-cit",level:3},{value:"Merchant Initiated Transactions (MIT)",id:"mit",level:3},{value:"Standing Instruction MITs",id:"standing-instruction-mits",level:4},{value:"Industry-Specific Business Practice MIT",id:"industry-specific-business-practice-mit",level:4},{value:"Types of MIT",id:"types-of-mit",level:4},{value:"Request Fields",id:"request-fields",level:3},{value:"Credentials on File Matrix",id:"credentialsOnFileMatrix",level:3},{value:"Recurring Transaction Agreements",id:"recurringtransactionagreements",level:2},{value:"Scheduling",id:"scheduling",level:3},{value:"Fixed Scheduling",id:"fixed-scheduling",level:4},{value:"Variable Scheduling",id:"variableScheduling",level:4},{value:"Request Fields",id:"rtaRequestFields",level:3},{value:"Response Fields",id:"response-fields",level:3},{value:"Gateway Wallet",id:"gatewayWallet",level:2},{value:"Benefits",id:"benefits",level:4},{value:"Limitations",id:"limitations",level:4},{value:"Implementation",id:"implementation",level:3},{value:"Request Fields",id:"request-fields-1",level:3},{value:"Response Fields",id:"response-fields-1",level:3},{value:"Payment Tokenisation",id:"paymentTokenisation",level:2},{value:"PREAUTH, SALE, REFUND, VERIFY requests",id:"preauth-sale-refund-verify-requests",level:3},{value:"REFUND_SALE requests",id:"refund_sale-requests",level:3},{value:"CANCEL or CAPTURE requests",id:"cancel-or-capture-requests",level:3},{value:"QUERY requests",id:"query-requests",level:3},{value:"SALE or REFUND Referred Authorisation requests",id:"sale-or-refund-referred-authorisation-requests",level:3}],u={toc:d};function p(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"credentials-on-file--recurring-transactions"},"Credentials on file & Recurring Transactions"),(0,r.kt)("h2",{id:"credentials-on-file"},"Credentials on File"),(0,r.kt)("p",null,"You may need to repeat a payment or perform a new payment using payment details previously requested from the Customer and stored by either yourself or the Gateway. These payment details could be stored in previous transaction or in the Gateway wallet. These repeat payments could be one off payments, scheduled recurring payments, or repeats due to authorisation problems or industry requirements. All must be correctly flagged to allow the payment network to process them."),(0,r.kt)("p",null,"The stored details, or credentials, are termed Credentials on File (COF) and refer to any payment details (including, but not limited to, an account number or payment token) that the Consumer has authorised you to store to perform future transactions without the need for them to enter their payment details again."),(0,r.kt)("p",null,"These transactions must always be identified with the reason for storing or using the stored credentials and who initiated the transaction \u2013 the Consumer (CIT) or the Merchant (MIT)."),(0,r.kt)("p",null,"You may store the credentials and send them with the future transaction, or you may store the details in the ",(0,r.kt)("a",{parentName:"p",href:"#gatewayWallet"},"Gateway\u2019s Wallet")," or by taking advantage of the ",(0,r.kt)("a",{parentName:"p",href:"#paymentTokenisation"},"payment tokenisation")," feature of the Gateway. Either way you must tell the Gateway of your intentions, it will not assume that just because you have asked, for example, to store credentials in the Wallet that those are legitimate stored credentials and follow all the requirements laid out below."),(0,r.kt)("p",null,"If you store credentials on file, then you must:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Disclose to consumers how those credentials will be used."),(0,r.kt)("li",{parentName:"ul"},"Obtain consumers\u2019 consent to store the credentials."),(0,r.kt)("li",{parentName:"ul"},"Notify consumers when any changes are made to the terms of use."),(0,r.kt)("li",{parentName:"ul"},"Inform the card issuer via a transaction that payment credentials are now stored on file."),(0,r.kt)("li",{parentName:"ul"},"Identify transactions with appropriate ",(0,r.kt)("inlineCode",{parentName:"li"},"rtAgreementType")," when using stored credentials. "),(0,r.kt)("li",{parentName:"ul"},"Perform a PREAUTH, SALE or VERIFY transaction during the initial credential setup.")),(0,r.kt)("p",null,"Note: Credentials stored to complete a single transaction (or a single purchase) for a Consumer, including multiple authorisations related to that particular transaction or future refunds are not considered stored credentials and can be stored and used without following the above rules."),(0,r.kt)("p",null,"Note: A new recurring transaction will be a clone of the cross-referenced transaction, including any stored credentials details except for any new data provided in the new transaction. If the new transaction provided different payment details, then any stored credentials in the cross-referenced transaction cannot be used. The ",(0,r.kt)("inlineCode",{parentName:"p"},"cloneFields")," request field can also be used to control which fields in the cross-referenced transaction are used in the repeat transaction (refer to ",(0,r.kt)("a",{parentName:"p",href:"annexes#transactionCloning"},"Transaction Cloning"),")."),(0,r.kt)("h3",{id:"consumer-initiated-transactions-cit"},"Consumer Initiated Transactions (CIT)"),(0,r.kt)("p",null,"Consumer Initiated Transactions (CIT) are any transaction where the Consumer is actively participating in the transaction. This can be either through a checkout experience online, via a mail order or telephone order, with or without the use of an existing stored credential."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"A Consumer Initiated Transaction is one whose action field is one of PREAUTH, SALE or VERIFY and whose type is one of 1 (ECOM) or 2 (MOTO).")),(0,r.kt)("p",null,"To indicate that the card details are to be stored as, or were stored as, Credentials on File then send the ",(0,r.kt)("inlineCode",{parentName:"p"},"rtAgreementType")," field as one of the following values:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cardonfile \u2013 card details stored as Credential on File"),(0,r.kt)("li",{parentName:"ul"},"recurring \u2013 initial payment as the start of a recurring payment agreement."),(0,r.kt)("li",{parentName:"ul"},"instalment \u2013 initial payment as the start of an instalment payment agreement.")),(0,r.kt)("p",null,"If the card details are cloned from an existing transaction or loaded from a Gateway Wallet which also stored the Credentials on File, then the transaction will be flagged as subsequent use of stored credentials rather than first use of them."),(0,r.kt)("p",null,"If the transaction is the first in a recurring or instalment sequence then the optional ",(0,r.kt)("inlineCode",{parentName:"p"},"rtSequenceCount")," field can be used to specify how many transactions will be taken in total, with a value greater than 1, and any optional ",(0,r.kt)("inlineCode",{parentName:"p"},"rtSequenceNumber")," field specifying which transaction it is in the sequence will be expected to have a value of 0."),(0,r.kt)("h3",{id:"mit"},"Merchant Initiated Transactions (MIT)"),(0,r.kt)("p",null,"Merchant Initiated Transactions (MIT) are any transaction where you have performed the transaction without the active participation of the Consumer. This would normally always be as a follow-up to a previous Consumer Initiated Transaction (CIT). The Gateway can be instructed to take Merchant Initiated recurring transactions automatically, according to a pre-determined schedule. Merchant Initiated Transactions are broken down in to two categories as follows."),(0,r.kt)("h4",{id:"standing-instruction-mits"},"Standing Instruction MITs"),(0,r.kt)("p",null,"Merchant Initiated Transactions defined under this category are performed to address pre-agreed standing instructions from the Consumer for the provision of goods or services."),(0,r.kt)("p",null,"The following transaction types are standing instructions transactions:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Instalment Payments: A transaction in a series of transactions that use a stored credential and that represent Consumer agreement for the merchant to initiate one or more future transactions over a period for a single purchase of goods or services. An example of such a transaction is a higher purchase repayment."),(0,r.kt)("li",{parentName:"ul"},"Recurring Payments: A transaction in a series of transactions that use a stored credential and that are processed at fixed, regular intervals (not to exceed one year between transactions), representing Consumer agreement for the merchant to initiate future transactions for the purchase of goods or services provided at regular intervals. An example of such a transaction is a gym membership subscription."),(0,r.kt)("li",{parentName:"ul"},"Unscheduled Credential on File (UCOF): A transaction using a stored credential for a fixed or variable amount that does not occur on a scheduled or regularly occurring transaction date, where the Consumer has provided consent for the merchant to initiate one or more future transactions. An example of such a transaction is an account auto-top up transaction.")),(0,r.kt)("p",null,"The Gateway classifies the first two types of instalment and recurring payments as Continuous Authority (CA) payments and the third type as a normal Cardholder not present payments. Different Acquirers may use different classifications, but the Gateway will handle this and send the classification expected by the Acquirer."),(0,r.kt)("p",null,"The maximum period between each transaction is 13 months, however individual Card Schemes or Acquirers may impose shorter periods."),(0,r.kt)("h4",{id:"industry-specific-business-practice-mit"},"Industry-Specific Business Practice MIT"),(0,r.kt)("p",null,"Merchant Initiated Transactions defined under this category are performed to fulfil a business practice as a follow-up to an original Consumer-Merchant interaction that could not be completed with one single transaction. Not every industry practice Merchant Initiated Transaction requires a stored credential, for example, if you store card details for a single transaction or a single purchase, it is not considered as a stored credential transaction."),(0,r.kt)("p",null,"The following transaction types are industry specific transactions:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Incremental: Incremental authorizations can be used to increase the total amount authorised if the authorised amount is insufficient. An incremental authorization request may also be based on a revised estimate of what the Consumer may spend. The Gateway does not currently support incremental authorisations."),(0,r.kt)("li",{parentName:"ul"},"Resubmission: You can perform a resubmission in cases where it requested an authorization but received a decline due to insufficient funds; however, the goods or services were already delivered to the Consumer. In such scenarios, you can resubmit the request to recover outstanding debt from Consumers."),(0,r.kt)("li",{parentName:"ul"},"Reauthorization: You can initiate a reauthorization when the completion or fulfilment of the original order or service extends beyond the authorization validity limit set by the Card Scheme."),(0,r.kt)("li",{parentName:"ul"},"Delayed Charges: Delayed charges are performed to make a supplemental account charge after original services have been rendered and payment has been processed."),(0,r.kt)("li",{parentName:"ul"},"No Show: Consumers can use their payment credentials to make a guaranteed reservation with certain merchant segments. A guaranteed reservation ensures that the reservation will be honoured and allows you to perform a No Show transaction to charge the Consumer a penalty according to your cancellation policy. If no payment is made to guarantee a reservation, then it is necessary to perform a VERIFY Consumer Initiated Transaction at the time of reservation to be able perform a No Show transaction later.")),(0,r.kt)("h4",{id:"types-of-mit"},"Types of MIT"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"A Merchant Initiated Transaction is one whose action field is one of PREAUTH, SALE or VERIFY and whose type is one of 2 (MOTO) or 9 (CA) depending on the category.")),(0,r.kt)("p",null,"To indicate the type of MIT, send the ",(0,r.kt)("inlineCode",{parentName:"p"},"rtAgreementType")," field as one of the following values:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"recurring \u2013 subsequent payment as the start of a recurring payment agreement (CA)."),(0,r.kt)("li",{parentName:"ul"},"instalment \u2013 subsequent payment as the start of an instalment payment agreement (CA)."),(0,r.kt)("li",{parentName:"ul"},"unscheduled \u2013 subsequent payment not to a fixed schedule (MOTO)"),(0,r.kt)("li",{parentName:"ul"},"incremental \u2013 subsequent payment to increment initial amount authorised (MOTO)"),(0,r.kt)("li",{parentName:"ul"},"resubmission \u2013 subsequent payment due to failed initial payment (MOTO)"),(0,r.kt)("li",{parentName:"ul"},"reauthorisation \u2013 subsequent payment to refresh expired initial payment (MOTO)"),(0,r.kt)("li",{parentName:"ul"},"delayedcharges \u2013 subsequent payment for additional charges (MOTO)"),(0,r.kt)("li",{parentName:"ul"},"noshow \u2013 subsequent payment as penalty for missed reservation (MOTO)")),(0,r.kt)("p",null,"In addition, the optional ",(0,r.kt)("inlineCode",{parentName:"p"},"rtSequenceCount")," field can be used to specify how many transactions will be taken in total, with a value greater than 1, and the optional rtSequenceNumber field can be used to specify which transaction this is in the sequence, with a value greater than 0."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," of the initial Consumer Initiated Transaction, or previous Merchant Initiated Transaction must be provided as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For standing order MITs the initial authorisation must have been a successful Consumer Initiated Transaction with Credentials on File. This MIT will be a subsequent use of those Credentials on File. For recurring and instalment MITs the initial authorisation must have used the same ",(0,r.kt)("inlineCode",{parentName:"p"},"rtAgreementType"),". The xref can be to the previous MIT in which case the Gateway will follow the chain of transactions back to the initial CIT. An xref is only valid for 13 months and so there cannot be longer between recurring payments, however the Card Scheme or Acquirer may impose a shorter period.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"For industry practice MITs the initial authorisation must be successful (apart from for a resubmission) but need not have Credentials on File. For example, it may not be known at the time of the initial authorisation that the MIT would be required and so the initial authorisation would not necessarily have stored the Credentials on File. This is an example of when an industry practice Merchant Initiated Transaction does not require a stored credential\nNote: For compatibility with existing practices, Instalment Payments and Recurring Payments MITs use Continuous Authority (CA) type transactions while other MITs Mail Order/Telephone Order (MOTO) type transactions. This use of MOTO is different to its use with a Consumer Initiated Transaction (CIT)."))),(0,r.kt)("h3",{id:"request-fields"},"Request Fields"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"xref"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to initial CIT or previous MIT transaction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"type"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"The type of transaction.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," 1 \u2013 E-commerce (ECOM) (CIT).",(0,r.kt)("br",null)," 2 \u2013 Mail Order/Telephone Order (MOTO (CIT).",(0,r.kt)("br",null)," 9 \u2013 Continuous Authority (CA) (MIT).",(0,r.kt)("br",null)," ",(0,r.kt)("br",null)," Required differentiate between initial and subsequent recurring or instalment transaction.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtAgreementType"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Consumer/Merchant agreement type.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are: ",(0,r.kt)("br",null),"cardonfile \u2013 credential storage agreed (CIT/MIT).",(0,r.kt)("br",null)," recurring \u2013 recurring type agreed (CIT/MIT). ",(0,r.kt)("br",null),"instalment \u2013 instalment type agreed (CIT/MIT).",(0,r.kt)("br",null)," unscheduled \u2013 ad hoc COF payment (MIT). ",(0,r.kt)("br",null),"incremental \u2013 authorisation amount increment (MIT). ",(0,r.kt)("br",null),"resubmission \u2013 failed authorisation retry (MIT).",(0,r.kt)("br",null)," reauthorisation \u2013 expired authorisation refresh (MIT). ",(0,r.kt)("br",null),"delayedcharges \u2013 post authorisation charges (MIT).",(0,r.kt)("br",null)," noshow \u2013 missed reservation penalty (MIT).",(0,r.kt)("br",null),(0,r.kt)("br",null),"Not required on the initial transaction for a subsequent Industry-Specific Business Practice MIT to be used. ",(0,r.kt)("br",null),(0,r.kt)("br",null),"MIT type incremental is not currently supported but reserved for future use.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtSequenceCount"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of transactions in a recurring sequence if known. ",(0,r.kt)("br",null),(0,r.kt)("br",null),"Mandatory for some Acquirers, its use is highly recommended with recurring transactions.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtSequenceNumber"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Transaction number in a recurring sequence if known.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"initiator"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Indicate who initiated the transaction.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are: ",(0,r.kt)("br",null),"consumer \u2013 consumer initiated (CIT) ",(0,r.kt)("br",null),"merchant \u2013 merchant initiated (MIT)",(0,r.kt)("br",null),(0,r.kt)("br",null)," If not provided the Gateway will attempt to determine the initiator from the other request values.")))),(0,r.kt)("p",null,"For backwards compatibility, the Gateway will try to automatically identify if a transaction is CIT or MIT from the values provided for the ",(0,r.kt)("inlineCode",{parentName:"p"},"action"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"rtAgreementType")," fields."),(0,r.kt)("p",null,"You may also pass the ",(0,r.kt)("inlineCode",{parentName:"p"},"initiator")," field in the request to force a classification. This can be used if the Gateway is unable to correctly classify the transaction. If, however, the requested classification is incompatible with the provided request fields then the transaction will fail with a ",(0,r.kt)("inlineCode",{parentName:"p"},"   ")," of 66944 (INVALID INITIATOR)."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"initiator")," field will be returned in the response with either the value passed in the request or the automatically identified value."),(0,r.kt)("h3",{id:"credentialsOnFileMatrix"},"Credentials on File Matrix"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Scenario"),(0,r.kt)("th",{parentName:"tr",align:null},"CIT/MIT"),(0,r.kt)("th",{parentName:"tr",align:null},"CNP"),(0,r.kt)("th",{parentName:"tr",align:null},"COF"),(0,r.kt)("th",{parentName:"tr",align:null},"SCA (3D Secure)"),(0,r.kt)("th",{parentName:"tr",align:null},"initiator"),(0,r.kt)("th",{parentName:"tr",align:null},"type"),(0,r.kt)("th",{parentName:"tr",align:null},"rtAgreementType"),(0,r.kt)("th",{parentName:"tr",align:null},"xref"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder opts to store their card details on Merchant's website."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"ECOMMERCE"),(0,r.kt)("td",{parentName:"tr",align:null},"initial"),(0,r.kt)("td",{parentName:"tr",align:null},"Required"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"cardonfile"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder opts to store their card details provided to Merchant via mail or telephone."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"initial"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"cardonfile"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder pays using a card they previously stored on the Merchant's website."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"ECOMMERCE"),(0,r.kt)("td",{parentName:"tr",align:null},"Subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Required"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"cardonfile"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to transaction that initially stored the card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder provides their card details to sign up to a subscription on the Merchant's website."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"ECOMMERCE"),(0,r.kt)("td",{parentName:"tr",align:null},"initial or subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Required"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"recurring"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning or using previous stored card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder provides their card details when agreeing to purchase by instalments on the Merchant's website."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"ECOMMERCE"),(0,r.kt)("td",{parentName:"tr",align:null},"initial or subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Required"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"1"),(0,r.kt)("td",{parentName:"tr",align:null},"instalment"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning or using previous stored card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder provides their card details to sign up to a subscription via mail or telephone to the Merchant."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"initial or subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"recurring"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning or using previous stored card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Cardholder provides their card details when agreeing to purchase by instalments via mail or telephone to the Merchant."),(0,r.kt)("td",{parentName:"tr",align:null},"CIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"initial or subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"consumer"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"instalment"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional for cloning or using previous stored card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant/Gateway takes an automatic subscription payment at the interval agreed to by the Cardholder."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"Continuous Authority"),(0,r.kt)("td",{parentName:"tr",align:null},"Subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"9"),(0,r.kt)("td",{parentName:"tr",align:null},"recurring"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to initial or previous recurring payment")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant/Gateway makes an automatic instalment payment at the interval agreed to by the Cardholder."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"Continuous Authority"),(0,r.kt)("td",{parentName:"tr",align:null},"Subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"9"),(0,r.kt)("td",{parentName:"tr",align:null},"instalment"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to initial or previous instalment payment")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant makes an unscheduled transaction, such as an account top-up, as previously agreed with the Cardholder when they stored their card details."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"Subsequent"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"unscheduled"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to transaction that initially stored the card")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant resubmits a payment where the initial payment was declined due to insufficient funds, but the goods have already been provided to the Cardholder."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"resubmission"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to initial payment that was declined")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant reauthorises a payment when the completion or fulfilment of the original order or service extends beyond the authorization validity limit set by the Card Scheme."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"reauthorisation"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to payment that is to be reauthorised")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant makes a payment to process a supplemental account charge after original services have been rendered and respective payment has been processed."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to original payment to which the delayed charges relate")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merchant makes a payment to charge the Cardholder a penalty according to the merchant\u2019s reservation cancellation policy."),(0,r.kt)("td",{parentName:"tr",align:null},"MIT"),(0,r.kt)("td",{parentName:"tr",align:null},"MOTO"),(0,r.kt)("td",{parentName:"tr",align:null},"N/A"),(0,r.kt)("td",{parentName:"tr",align:null},"Exempt"),(0,r.kt)("td",{parentName:"tr",align:null},"merchant"),(0,r.kt)("td",{parentName:"tr",align:null},"2"),(0,r.kt)("td",{parentName:"tr",align:null},"noshow"),(0,r.kt)("td",{parentName:"tr",align:null},"Reference to an initial CIT payment or account verification payment made by Cardholder at time of booking")))),(0,r.kt)("h2",{id:"recurringtransactionagreements"},"Recurring Transaction Agreements"),(0,r.kt)("p",null,"A Recurring Transaction Agreement (RTA) is used to request that the Gateway should perform repeat payments on your behalf, using pre-agreed amounts and schedules."),(0,r.kt)("p",null,"An RTA can be configured easily and quickly, using the Merchant Management System (MMS). An RTA can also be set up while performing the initial transaction request, by including the integration ",(0,r.kt)("a",{parentName:"p",href:"#rtaRequestFields"},"RTA request fields"),". The RTA is only set up in the transaction results in a successful payment authorisation.\nThe initial transaction should be either SALE or VERIFY transaction and the ",(0,r.kt)("inlineCode",{parentName:"p"},"rtAgreementType")," field should be provided to indicate whether the transactions are part of a recurring or instalment."),(0,r.kt)("p",null,"Merchants who use this system to implement billing or subscription type payments must use recurring or instalment type Continuous Authority (CA) transactions to comply with Card Payment Scheme practices. Your Acquirer may refuse to accept the recurring transactions if they are not subject to an agreement between yourself and your Customer."),(0,r.kt)("p",null,"The maximum period between recurring transactions is 13 months, however individual Acquirers may impose a shorter period."),(0,r.kt)("p",null,"Refer to the ",(0,r.kt)("a",{parentName:"p",href:"credentialsonfile"},"Credentials on File")," section for more information on the different types of repeat or recurring transactions."),(0,r.kt)("h3",{id:"scheduling"},"Scheduling"),(0,r.kt)("p",null,"There are two different types of scheduling available when requesting the Gateway to take recurring transactions automatically on the Merchant\u2019s behalf. In addition, a start date can be provided to allow for a recurring subscription with an initial free trial period."),(0,r.kt)("h4",{id:"fixed-scheduling"},"Fixed Scheduling"),(0,r.kt)("p",null,"Fixed scheduling causes the subsequent transaction to be taken at fixed intervals of time and for fixed amounts. A different initial date and amount or final date and amount can be provided for use when the agreed payment term or amount doesn\u2019t exactly divide by the fixed time intervals."),(0,r.kt)("p",null,"Fixed scheduling is specified by providing an ",(0,r.kt)("inlineCode",{parentName:"p"},"rtScheduleType")," field with a value of \u2018fixed\u2019 and providing the ",(0,r.kt)("inlineCode",{parentName:"p"},"rtCycleDuration"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"rtCycleAmount")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"rtCycleCount")," fields to define the interval at which transactions should be taken and the number of transactions to take."),(0,r.kt)("p",null,"An ",(0,r.kt)("inlineCode",{parentName:"p"},"rtCycleCount")," field value of 0 can be provided to indicate that transactions should be taken ad-infinitum until the RTA is stopped."),(0,r.kt)("h4",{id:"variableScheduling"},"Variable Scheduling"),(0,r.kt)("p",null,"Variable scheduling causes the subsequent transaction to be taken on prespecified dates and for prespecified amounts."),(0,r.kt)("p",null,"Variable scheduling is specified by providing an ",(0,r.kt)("inlineCode",{parentName:"p"},"rtScheduleType")," field with a value of \u2018variable\u2019 and providing the ",(0,r.kt)("inlineCode",{parentName:"p"},"rtSchedule")," field with a value containing an array of one or more schedule records."),(0,r.kt)("p",null,"Each schedule record must contain the following fields:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"date"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Date on which to take a payment.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"amount"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Amount to take on the provided date.")))),(0,r.kt)("p",null,"The schedule records should be passed in a sequential array of records, either as nested records or serialised records as described in the ",(0,r.kt)("a",{parentName:"p",href:"overview#fieldFormats"},"format guide"),". The record field names are case sensitive."),(0,r.kt)("h3",{id:"rtaRequestFields"},"Request Fields"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtName"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Free format short name for the agreement.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtDescription"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Free format longer description for the agreement.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtPolicyRef"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Policy Reference Number (MPRN).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtAgreementType"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Recurring transaction agreement type. Indicates the type of Continuous Payment Authority or Repeat Billing agreement made with the Cardholder.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," recurring \u2013 recurring type CPA agreed.",(0,r.kt)("br",null)," instalment \u2013 instalment type CPA agreed.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtMerchantID"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Account ID to use for the recurring transactions (defaults to merchantID).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtStartDate"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Start date of agreement (defaults to date received).")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtScheduleType"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Schedule type. ",(0,r.kt)("br",null),(0,r.kt)("br",null),"Possible values are: ",(0,r.kt)("br",null),"fixed \u2013 fixed interval schedule (default). ",(0,r.kt)("br",null),"variable \u2013 variable interval schedule.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtSchedule"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Nested array or serialised string containing payment schedule information as per the ",(0,r.kt)("a",{parentName:"td",href:"#variableScheduling"},"variable scheduling")," section.",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with variable schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtInitialDate"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Date of initial payment (defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"rtStartDate"),").",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtInitialAmount"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Amount of initial payment (defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"rtCycleAmount"),").",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtFinalDate"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Date of final payment.",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtFinalAmount"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Amount of final payment (defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"rtCycleAmount"),").",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtCycleAmount"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Amount per cycle (defaults to ",(0,r.kt)("inlineCode",{parentName:"td"},"amount"),").",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtCycleDuration"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Length of each cycle in ",(0,r.kt)("inlineCode",{parentName:"td"},"rtCycleDurationUnit")," units.",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtCycleDurationUnit"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Cycle duration unit. One of: day, week, month or year.",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtCycleCount"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("span",{class:"badge badge--primary"},"Yes")),(0,r.kt)("td",{parentName:"tr",align:null},"Number of cycles to repeat (zero to repeat forever).",(0,r.kt)("br",null),(0,r.kt)("br",null),"For use with fixed schedules only.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtMerchantData"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Free format Merchant data field.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtCloneFields"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Fields to clone from one recurring transaction to the next. Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#transactionCloning"},"Transaction Cloning"))))),(0,r.kt)("h3",{id:"response-fields"},"Response Fields"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Returned"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtID"),(0,r.kt)("td",{parentName:"tr",align:null},"Always"),(0,r.kt)("td",{parentName:"tr",align:null},"Recurring Transaction Agreement ID.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtResponseCode"),(0,r.kt)("td",{parentName:"tr",align:null},"Always"),(0,r.kt)("td",{parentName:"tr",align:null},"Result of setting up RT Agreement.Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#responseCodes"},"Response Codes")," for details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"rtResponseMessage"),(0,r.kt)("td",{parentName:"tr",align:null},"Always"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of above response code.")))),(0,r.kt)("h2",{id:"gatewayWallet"},"Gateway Wallet"),(0,r.kt)("p",null,"The Gateway supports an internal digital Wallet that is available to all Merchants using the Gateway."),(0,r.kt)("p",null,"The Gateway allows you to store your Customer\u2019s payment card, billing and delivery address details and other information securely encrypted in its internal Wallet. You can then allow your Customer to select from stored payment cards to check out faster on your website."),(0,r.kt)("p",null,"Management of this Wallet is done using the Gateway\u2019s REST API. However, you can use the Hosted, Direct or Batch Integrations to perform transactions, using cards and addresses stored in the Wallet; or to store new cards and address used with successful transactions."),(0,r.kt)("h4",{id:"benefits"},"Benefits"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Details can be used from or added to the Wallet with just a few extra integration fields."),(0,r.kt)("li",{parentName:"ul"},"Customers can select from previously stored details, making the checkout process more streamlined, resulting in fewer abandoned carts and thus increasing sales."),(0,r.kt)("li",{parentName:"ul"},"Compatible with existing card base fraud solutions such as Address Verification Service (AVS), 3-D Secure and third-party fraud providers."),(0,r.kt)("li",{parentName:"ul"},"There are no extra costs to use the internal Gateway Wallet."),(0,r.kt)("li",{parentName:"ul"},"The Wallet transactions are controlled within the Merchant Management System (MMS) in the same manner as normal card transactions."),(0,r.kt)("li",{parentName:"ul"},"Stored cards are assigned a Card Token which is fully LUHN checkable PAN ending in the same last 4 digits as stored card and thus can be used to replace the PAN in any system that is expecting to store PANs and not arbitrary card identifiers.")),(0,r.kt)("h4",{id:"limitations"},"Limitations"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The payment details are stored internally by the Gateway and not available for use with other Gateway Merchants or other payment gateways.")),(0,r.kt)("h3",{id:"implementation"},"Implementation"),(0,r.kt)("p",null,"If a transaction is sent to the Direct Integration, then with the addition of a few extra integration fields, it can be instructed to use payment details stored in the Wallet and/or store the used payment details."),(0,r.kt)("p",null,"Using stored payment details is similar to performing cross-referenced transactions where the payment details are cloned from a previous transaction. However, in this case the payment details are taken from the Wallet and not a previous transaction."),(0,r.kt)("p",null,"The details are only saved if the transaction is successful, ensuring that the Wallet is not filled up with invalid payment details."),(0,r.kt)("p",null,"The details requiring to be stored in the Wallet are validated when the transaction is performed prior to any authorisation with the Acquirer. If any of the details are invalid, then the transaction will be aborted with a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 66304 (INVALID_REQUEST) and a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseMessage")," indicating which data could not be stored in the Wallet. Any failure that occurs post authorisation will not abort the transaction but will be available in the appropriate ",(0,r.kt)("inlineCode",{parentName:"p"},"xxxxStoreResponseCode")," response fields."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"walletOwnerRef")," field can be used to assign a unique Customer reference to the Wallet allowing you to identify which of your Customers owns the Wallet. This could be the Customer reference you use within your own Customer accounts or Shopping Cart software. You must ensure that this value is less than 50 characters, or the transaction will be aborted with a ",(0,r.kt)("inlineCode",{parentName:"p"},"responseCode")," of 65xxx (INVALID_WALLETCUSTOMERREF)."),(0,r.kt)("h3",{id:"request-fields-1"},"Request Fields"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletID"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier for an existing Wallet to use.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletName"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name for any new Wallet created.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletDescription"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description for any new Wallet created.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletOwnerRef"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Owner Reference for any new Wallet created.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletData"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Data for any new Wallet created.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletStore"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Request that all payment details be stored in the Wallet. A new Wallet will be created if needed.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," Y- store all payment details.",(0,r.kt)("br",null)," N- store details according to their ",(0,r.kt)("inlineCode",{parentName:"td"},"xxxStore")," value.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardID"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier for an existing card stored in a Wallet.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardToken"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier for an existing card stored in a Wallet represented as valid PAN ending with same last 4 digits as the stored PAN.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardName"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name for any new card stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardDescription"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description for any new card stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardData"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Data for any new card stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardStore"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Request that the payment card details be stored in the Wallet. A new Wallet will be created if needed.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," Y- store the card details.",(0,r.kt)("br",null)," N- do not store the card details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressID"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier for an existing address stored in a Wallet.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressName"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressDescription"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressData"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Data for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressStore"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Request that the customer address details be stored in the Wallet. A new Wallet will be created if needed.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," Y- store the customer address details.",(0,r.kt)("br",null)," N- do not store the customer address details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressID"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier for an existing address stored in a Wallet.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressName"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Name for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressDescription"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressData"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Merchant Data for any new address stored.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressStore"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Request that the delivery address details be stored in the Wallet. A new Wallet will be created if needed.",(0,r.kt)("br",null),(0,r.kt)("br",null)," Possible values are:",(0,r.kt)("br",null)," Y- store the delivery address details.",(0,r.kt)("br",null)," N- do not store the delivery address details.")))),(0,r.kt)("h3",{id:"response-fields-1"},"Response Fields"),(0,r.kt)("p",null,"These fields will be returned in addition to the request fields from section."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Mandatory"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletStoreResponseCode"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Result of creating or updating the Wallet details. Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#responseCodes"},"Response Codes")," for details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"walletStoreResponseMessage"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of above response code.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardStoreResponseCode"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Result of creating or updating the card details. Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#responseCodes"},"Response Codes")," for details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"cardStoreResponseMessage"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of above response code.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddresStoreResponseCode"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Result of creating or updating the address details. Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#responseCodes"},"Response Codes")," for details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"customerAddressStoreResponseMessage"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of above response code.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressStoreResponseCode"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Result of creating or updating the address details. Refer to ",(0,r.kt)("a",{parentName:"td",href:"annexes#responseCodes"},"Response Codes")," for details.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"deliveryAddressStoreResponseMessage"),(0,r.kt)("td",{parentName:"tr",align:null},"No"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of above response code.")))),(0,r.kt)("p",null,"If new items are stored in the Wallet, then their identifiers will be returned in the appropriate walletID, cardID, customerAddressID and deliveryAddressID together with any values provided for or assigned by default to the other item fields."),(0,r.kt)("p",null,"Failure to store any of the details in the Wallet will be reported using the appropriate ",(0,r.kt)("inlineCode",{parentName:"p"},"xxxxStoreResponseCode")," response field."),(0,r.kt)("h2",{id:"paymentTokenisation"},"Payment Tokenisation"),(0,r.kt)("p",null,"All new transactions stored by the Gateway are assigned a unique reference number that is referred to as the cross reference and returned in the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," response field. This cross reference is displayed on the Merchant Management System (MMS) and used whenever a reference to a previous transaction is required."),(0,r.kt)("p",null,"The cross reference can be sent as part of a transaction request, in the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," request field, to tell the Gateway to perform an action on an existing transaction. This is usually for management actions such as CANCEL or CAPTURE."),(0,r.kt)("p",null,"The cross reference can also be sent with new transactions such as PREAUTH, SALE, and REFUND actions, to request that the Gateway uses the values from the existing transaction if they have not been specified in the new request. For more information on how the existing values are used, please refer to the ",(0,r.kt)("a",{parentName:"p",href:"annexes#transactionCloning"},"transaction cloning")," section. This allows an existing transaction to be effectively repeated without you needing to know the original card number. The only exception to this is the card\u2019s security code (CVV) which the Gateway cannot store, due to PCI DSS restrictions. Accordingly, it will have to be supplied in the new request (unless the new request is a Continuous Authority transaction, refer to the ",(0,r.kt)("a",{parentName:"p",href:"transactiontypes#continuousAuthority"},"continuous authority")," section."),(0,r.kt)("p",null,"The use of cross references to perform repeat transactions is referred to as Payment Tokenisation and should not be confused with Card Tokenisation which is a separate service offered by the Gateway."),(0,r.kt)("p",null,"Refer to the ",(0,r.kt)("a",{parentName:"p",href:"credentialsonfile"},"credentials on file")," section for details on how to instruct the Gateway to repeat a payment automatically."),(0,r.kt)("p",null,"The Gateway will make transaction details available for a maximum period of 13 months, after this time the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," to the transaction will be invalid. The card number will be available during this time, but you may request that it is removed sooner. Once the card number has been removed the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," can no longer be used to provide the number to a future a transaction."),(0,r.kt)("p",null,"The way each action handles any supplied ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," is as follows:"),(0,r.kt)("h3",{id:"preauth-sale-refund-verify-requests"},"PREAUTH, SALE, REFUND, VERIFY requests"),(0,r.kt)("p",null,"These requests will always create a new transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field can be provided to reference an existing transaction, which will be used to complete any missing fields in the current transaction. The previous transaction will not be modified. For more information on how the existing values are used, please refer to the ",(0,r.kt)("a",{parentName:"p",href:"annexes#transactionCloning"},"transaction cloning")," section. If the existing transaction cannot be found, then an error will be returned and recorded against the new transaction."),(0,r.kt)("p",null,"The request is expected to contain any transaction information required."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," will only be used to complete any missing card and order details, relieving you from having to store card details and reducing your PCI requirements."),(0,r.kt)("h3",{id:"refund_sale-requests"},"REFUND_SALE requests"),(0,r.kt)("p",null,"These requests will always create a new transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field can be provided to reference an existing transaction that is going to be refunded. This existing transaction will be marked as have been fully or partially refunded and the amounts will be tallied to ensure that you cannot refund more than the original amount of this existing transaction. If the existing transaction cannot be found, then an error will be returned and recorded against the new transaction."),(0,r.kt)("p",null,"The request is expected to contain any transaction information required."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," will not only be used to find the transaction to be refunded: additionally, that transaction will be used to complete any missing card and order details, relieving you from having to store card details and reducing your PCI requirements."),(0,r.kt)("h3",{id:"cancel-or-capture-requests"},"CANCEL or CAPTURE requests"),(0,r.kt)("p",null,"These requests will always modify an existing transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field must be provided to reference an existing transaction, which will be modified to the desired state. If the existing transaction cannot be found, then an error is returned but no record of the error will be recorded against any transaction."),(0,r.kt)("p",null,"The request must not contain any new transaction information any attempt to send any new transaction information will result in an error. The exception is that a CAPTURE request can send in a new lesser ",(0,r.kt)("inlineCode",{parentName:"p"},"amount")," field when a lesser amount, than originally authorised, must be settled."),(0,r.kt)("h3",{id:"query-requests"},"QUERY requests"),(0,r.kt)("p",null,"These requests will not create or modify any transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field must be provided to reference an existing transaction, which will be returned as if it had just been performed. If the existing transaction cannot be found, then an error is returned but no record of the error will be recorded against any transaction."),(0,r.kt)("p",null,"The request must not contain any new transaction information and any attempt to send any new transaction information will result in an error."),(0,r.kt)("h3",{id:"sale-or-refund-referred-authorisation-requests"},"SALE or REFUND Referred Authorisation requests"),(0,r.kt)("p",null,"These will always create a new transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field must be provided to reference an existing transaction, which must be of the same request type and be in the referred state. A new transaction will be created based upon this transaction. If the existing transaction cannot be found or is not in the referred state, then an error will be returned and recorded against the new transaction."),(0,r.kt)("p",null,"The new transaction will be put in the approved state and captured when specified by the existing or new transaction details. It will not be sent for authorisation again first."),(0,r.kt)("p",null,"The request may contain new transaction details, but any card details or order amount must be the same as the existing transaction. Any attempt to send different card details or order details will result in an error."),(0,r.kt)("p",null,"NB: This usage is very similar to a normal SALE or REFUND request sent with an ",(0,r.kt)("inlineCode",{parentName:"p"},"authorisationCode")," included. The difference is that the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," must refer to an existing referred transaction whose full details are used if required and not simply an existing transaction whose card details are used if required."),(0,r.kt)("p",null,"This means it is not possible to create a pre-authorised SALE or REFUND request and use a xref (ie to use the card and order details from an existing transaction). As a soon as the ",(0,r.kt)("inlineCode",{parentName:"p"},"xref")," field is seen, the Gateway identifies that it is a referred transaction that you wish to authorise."))}p.isMDXComponent=!0}}]);